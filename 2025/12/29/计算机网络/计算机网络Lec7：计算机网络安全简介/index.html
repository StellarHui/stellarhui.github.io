<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>计算机网络（7）：计算机网络安全简介 | 皓月星辰</title><meta name="author" content="摘星的辉"><meta name="copyright" content="摘星的辉"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本章的内容非常浅显（很多都是常识），但概念繁多。  网络安全原理与基础安全概念与基本原则核心目标：CIA Triad网络安全的一切工作都是围绕保护三个属性展开的：  机密性 (Confidentiality)：不仅是加密，还包括访问控制。防止未授权的“看”。 完整性 (Integrity)：防止未授权的“改”。包括篡改数据包、伪造发送者等。 可用性 (Availability)：防止“断”。确保">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络（7）：计算机网络安全简介">
<meta property="og:url" content="https://stellarhui.github.io/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/">
<meta property="og:site_name" content="皓月星辰">
<meta property="og:description" content="本章的内容非常浅显（很多都是常识），但概念繁多。  网络安全原理与基础安全概念与基本原则核心目标：CIA Triad网络安全的一切工作都是围绕保护三个属性展开的：  机密性 (Confidentiality)：不仅是加密，还包括访问控制。防止未授权的“看”。 完整性 (Integrity)：防止未授权的“改”。包括篡改数据包、伪造发送者等。 可用性 (Availability)：防止“断”。确保">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://stellarhui.github.io/img/favicon.jpg">
<meta property="article:published_time" content="2025-12-29T02:01:28.971Z">
<meta property="article:modified_time" content="2025-12-29T04:23:46.589Z">
<meta property="article:author" content="摘星的辉">
<meta property="article:tag" content="科研工作,学习笔记,个人成长">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://stellarhui.github.io/img/favicon.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "计算机网络（7）：计算机网络安全简介",
  "url": "https://stellarhui.github.io/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/",
  "image": "https://stellarhui.github.io/img/favicon.jpg",
  "datePublished": "2025-12-29T02:01:28.971Z",
  "dateModified": "2025-12-29T04:23:46.589Z",
  "author": [
    {
      "@type": "Person",
      "name": "摘星的辉",
      "url": "https://stellarhui.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://stellarhui.github.io/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机网络（7）：计算机网络安全简介',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/font.css"><meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/favicon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/ZJU%E8%AF%BE%E7%A8%8B/"><i class="fa-fw fas fa-book"></i><span> ZJU课程</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-lightbulb"></i><span> 核心知识</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"><i class="fa-fw fas fa-microchip"></i><span> 计算机体系结构</span></a></li><li><a class="site-page child" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><i class="fa-fw fas fa-network-wired"></i><span> 计算机网络</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-square-root-variable"></i><span> 数学</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E6%9D%82%E9%A1%B9/"><i class="fa-fw fas fa-ellipsis"></i><span> 杂项</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">皓月星辰</span></a><a class="nav-page-title" href="/"><span class="site-name">计算机网络（7）：计算机网络安全简介</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/ZJU%E8%AF%BE%E7%A8%8B/"><i class="fa-fw fas fa-book"></i><span> ZJU课程</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-lightbulb"></i><span> 核心知识</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"><i class="fa-fw fas fa-microchip"></i><span> 计算机体系结构</span></a></li><li><a class="site-page child" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><i class="fa-fw fas fa-network-wired"></i><span> 计算机网络</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-square-root-variable"></i><span> 数学</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E6%9D%82%E9%A1%B9/"><i class="fa-fw fas fa-ellipsis"></i><span> 杂项</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">计算机网络（7）：计算机网络安全简介</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-12-29T02:01:28.971Z" title="发表于 2025-12-29 10:01:28">2025-12-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-12-29T04:23:46.589Z" title="更新于 2025-12-29 12:23:46">2025-12-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">4.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><blockquote>
<p>本章的内容非常浅显（很多都是常识），但概念繁多。</p>
</blockquote>
<h1 id="网络安全原理与基础"><a href="#网络安全原理与基础" class="headerlink" title="网络安全原理与基础"></a>网络安全原理与基础</h1><h2 id="安全概念与基本原则"><a href="#安全概念与基本原则" class="headerlink" title="安全概念与基本原则"></a>安全概念与基本原则</h2><h3 id="核心目标：CIA-Triad"><a href="#核心目标：CIA-Triad" class="headerlink" title="核心目标：CIA Triad"></a>核心目标：CIA Triad</h3><p>网络安全的一切工作都是围绕保护三个属性展开的：</p>
<ul>
<li><strong>机密性 (Confidentiality)</strong>：不仅是加密，还包括<strong>访问控制</strong>。防止未授权的“看”。</li>
<li><strong>完整性 (Integrity)</strong>：防止未授权的“改”。包括篡改数据包、伪造发送者等。</li>
<li><strong>可用性 (Availability)</strong>：防止“断”。确保服务在攻击（如DoS）下依然能响应合法请求。</li>
<li><strong>补充属性</strong>：<ul>
<li><strong>认证 (Authentication)</strong>：是建立信任的前提，先验明正身，再赋予权限。</li>
<li><strong>不可否认性 (Non-repudiation)</strong>：类似于现实中的签字画押，通过数字签名实现，防止“抵赖”。</li>
</ul>
</li>
</ul>
<h3 id="安全设计原则-Saltzer-Schroeder"><a href="#安全设计原则-Saltzer-Schroeder" class="headerlink" title="安全设计原则 (Saltzer & Schroeder)"></a>安全设计原则 (Saltzer &amp; Schroeder)</h3><p>这些原则是判断一个系统设计好坏的标准，也是分析漏洞时的切入点：</p>
<ul>
<li><strong>简单性 (Economy of mechanism)</strong>：这是最重要的原则。<strong>复杂是安全的大敌</strong>。系统越复杂，Bug越多，攻击面越广。设计应尽可能简单紧凑。</li>
<li><strong>默认拒绝 (Fail-safe defaults)</strong>：白名单机制优于黑名单。如果不明确允许，就默认拒绝。</li>
<li><strong>完全仲裁 (Complete mediation)</strong>：不要以为检查过一次密码就万事大吉。<strong>每一次</strong>对敏感资源的访问都必须重新检查权限（防止TOCTTOU攻击）。</li>
<li><strong>最小权限 (POLA)</strong>：程序只应拥有完成工作所需的<strong>最小</strong>权限。这样即使被攻破，损失也由“Root级”降为“用户级”。</li>
<li><strong>纵深防御 (Defense in Depth)</strong>：不要只依赖一道防线（如边界防火墙），内部也需要隔离和监控。</li>
</ul>
<h2 id="攻击技术-Attacks"><a href="#攻击技术-Attacks" class="headerlink" title="攻击技术 (Attacks)"></a>攻击技术 (Attacks)</h2><p>攻击通常是一个链条：<strong>侦察 -&gt; 劫持/欺骗 -&gt; 破坏</strong>。下面我们依次介绍这几个点。</p>
<h3 id="侦察-Reconnaissance"><a href="#侦察-Reconnaissance" class="headerlink" title="侦察 (Reconnaissance)"></a>侦察 (Reconnaissance)</h3><p>侦察有2种方式：</p>
<h4 id="端口扫描-Port-Scanning"><a href="#端口扫描-Port-Scanning" class="headerlink" title="端口扫描 (Port Scanning)"></a><strong>端口扫描 (Port Scanning)</strong></h4><p>端口扫描的目标是：得到受害者机器哪个端口是活跃的。可以基于TCP握手协议，使用下面3种方式实现：</p>
<ul>
<li><strong>全连接扫描</strong>：完成TCP三次握手。优点是准确，缺点是会在服务器留下日志，易被发现。</li>
<li><strong>半开扫描 (Half-open/SYN Scan)</strong>：发送SYN，服务器回SYN/ACK后，攻击者直接发<strong>RST</strong>。<strong>核心优势</strong>：不建立完整连接，通常不会被应用层日志记录，更加隐蔽。</li>
<li><strong>ZMap/Netmap</strong>：利用无状态特性实现互联网规模的极速扫描。</li>
</ul>
<p><img src="/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/image-20251229112656155.png"></p>
<h4 id="路由探测-Traceroute"><a href="#路由探测-Traceroute" class="headerlink" title="路由探测 (Traceroute)"></a><strong>路由探测 (Traceroute)</strong></h4><p>利用IP包的TTL字段。发送TTL逐渐增加的UDP包，路径上的路由器丢包时会回传ICMP错误信息，从而<strong>暴露路由器IP与传输路径</strong>。</p>
<h3 id="嗅探与欺骗-Sniffing-Spoofing"><a href="#嗅探与欺骗-Sniffing-Spoofing" class="headerlink" title="嗅探与欺骗 (Sniffing & Spoofing)"></a>嗅探与欺骗 (Sniffing &amp; Spoofing)</h3><p>这是攻击的核心手段。<strong>欺骗 (Spoofing) 的本质是伪造身份（IP、MAC、DNS记录）</strong>。</p>
<h4 id="A-链路层：突破交换机隔离"><a href="#A-链路层：突破交换机隔离" class="headerlink" title="A. 链路层：突破交换机隔离"></a>A. 链路层：突破交换机隔离</h4><ul>
<li><strong>环境差异</strong>：在WiFi或Hub环境下，网卡开启<strong>混杂模式 (Promiscuous)</strong> 即可抓取所有包。但在交换机网络中，流量被隔离。</li>
<li><strong>攻击手段</strong>：<ol>
<li><strong>MAC泛洪 (Flooding)</strong>：用海量随机源MAC填满交换机的转发表 (CAM Table)。<strong>后果</strong>：交换机为了保持可用性，会退化成<strong>广播模式 (Hub)</strong>，将流量发往所有端口，攻击者即可嗅探。</li>
<li><strong>ARP欺骗 (Poisoning)</strong>：<strong>中间人攻击 (MITM) 的基石</strong>。<ul>
<li><strong>原理</strong>：ARP协议是无状态且盲目信任的。攻击者不断发送伪造的ARP响应：“我是IP X，我的MAC是攻击者MAC”。</li>
<li><strong>结果</strong>：受害者会将发往网关的流量发给攻击者，攻击者既可以监听也可以篡改。</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="B-网络层：IP欺骗与侧信道攻击"><a href="#B-网络层：IP欺骗与侧信道攻击" class="headerlink" title="B. 网络层：IP欺骗与侧信道攻击"></a>B. 网络层：IP欺骗与侧信道攻击</h4><ul>
<li><strong>IP Spoofing</strong>：直接修改发送源IP。对于UDP很简单，但对于TCP（有状态），攻击者必须猜对序列号 (SEQ)。</li>
<li><strong>Mitnick 攻击</strong>（经典的TCP信任关系利用）：<ul>
<li><strong>场景</strong>：服务器A信任服务器B（基于IP信任，无需密码）。</li>
<li><strong>步骤</strong>：<ol>
<li>DDoS打瘫服务器B（防止它发RST干扰）。</li>
<li>向A发SYN，观察返回的ISN（初始序列号），<strong>推测ISN生成规律</strong>。</li>
<li>伪造B的IP向A发SYN，并用推测出的SEQ号回复ACK，完成握手。</li>
<li>植入后门。</li>
</ol>
</li>
</ul>
</li>
<li><strong>TCP连接劫持 (Hijacking)</strong>：<ul>
<li><strong>场景</strong>：攻击者在通信路径上 (On-path)。</li>
<li><strong>现象</strong>：攻击者注入数据后，客户端和服务器的SEQ/ACK号会对不上，引发双方疯狂互回ACK纠正，形成<strong>ACK风暴</strong>。</li>
<li><strong>收尾</strong>：攻击者利用ARP欺骗或RST包来阻断正常通信，独占连接。</li>
</ul>
</li>
<li><strong>非路径 (Off-Path) TCP 攻击</strong>（高难度）：<ul>
<li><strong>挑战</strong>：攻击者不在路径上，看不到SEQ号。</li>
<li><strong>利用侧信道</strong>：利用Linux系统对<strong>Challenge ACK</strong>（当收到异常包时发的探测包）的速率限制（如每秒100个）。</li>
<li><strong>步骤</strong>：<ol>
<li>伪造受害者IP发包。</li>
<li><strong>侧信道探测</strong>：自己向服务器发包探测Challenge ACK的剩余配额。</li>
<li>如果配额减少，说明刚才伪造的包触发了服务器的Challenge ACK，从而推断出连接是否存在、端口号是否正确、甚至SEQ号范围。</li>
</ol>
</li>
</ul>
</li>
</ul>
<h4 id="C-应用层：DNS-欺骗-DNS-Spoofing"><a href="#C-应用层：DNS-欺骗-DNS-Spoofing" class="headerlink" title="C. 应用层：DNS 欺骗 (DNS Spoofing)"></a>C. 应用层：DNS 欺骗 (DNS Spoofing)</h4><ul>
<li><strong>本地欺骗</strong>：在局域网内抢先回复DNS请求。</li>
<li><strong>远程投毒 (Remote Poisoning)</strong>：<ul>
<li><strong>难点</strong>：必须猜对16位的Query ID (Transaction ID)。</li>
<li><strong>生日攻击 (Birthday Attack)</strong>：利用生日悖论，同时发送大量请求和大量伪造响应，将碰撞概率从 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.271ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1888 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(500,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(1000,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g></g></g></svg></mjx-container> 提升到 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.206ex;" xmlns="http://www.w3.org/2000/svg" width="3.939ex" height="2.398ex" role="img" focusable="false" viewBox="0 -969 1741 1060"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msqrt"><g transform="translate(853,0)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g></g><g data-mml-node="mo" transform="translate(0,109)"><path data-c="221A" d="M95 178Q89 178 81 186T72 200T103 230T169 280T207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397 -77Q398 -77 501 136T707 565T814 786Q820 800 834 800Q841 800 846 794T853 782V776L620 293L385 -193Q381 -200 366 -200Q357 -200 354 -197Q352 -195 256 15L160 225L144 214Q129 202 113 190T95 178Z"></path></g><rect width="888" height="60" x="853" y="849"></rect></g></g></g></svg></mjx-container> 量级。</li>
<li><strong>Kaminsky 攻击</strong>（大杀器）：<ul>
<li><strong>目标</strong>：污染整个域名的权威记录（不仅仅是一个www记录）。</li>
<li><strong>手法</strong>：不断查询不存在的子域名 (1.atk.com, 2.atk.com…)，强制目标DNS服务器去向权威DNS查询。</li>
<li><strong>Payload</strong>：在伪造的响应包中，利用<strong>胶水记录 (Glue Records)</strong> 区域，谎称“权威DNS的IP是攻击者的IP”。一旦缓存成功，该域名下所有解析都会被劫持。</li>
</ul>
</li>
<li><strong>防御</strong>：随机化源端口 (Source Port Randomization) + 随机化 Query ID（增加熵），以及 DNSSEC。</li>
</ul>
</li>
</ul>
<h3 id="3-破坏-DoS-DDoS"><a href="#3-破坏-DoS-DDoS" class="headerlink" title="3. 破坏 (DoS/DDoS)"></a>3. 破坏 (DoS/DDoS)</h3><p>以消耗资源为目的。</p>
<ul>
<li><strong>SYN Flooding</strong>：<ul>
<li><strong>原理</strong>：利用TCP三次握手。攻击者发SYN，服务器分配内存（Backlog Queue）并回SYN/ACK，等待ACK。攻击者不回ACK，导致服务器内存耗尽，拒绝正常服务。</li>
<li><strong>防御 - SYN Cookies</strong>：<strong>核心思想是用计算换内存</strong>。<ul>
<li>服务器收到SYN<strong>不分配内存</strong>。</li>
<li>将连接信息（IP、端口、时间戳、MSS）加密哈希成一个Cookie，放入回复的<strong>初始序列号 (ISN)</strong> 中。</li>
<li>只有当客户端回ACK（SEQ = ISN+1）时，服务器重新计算哈希验证Cookie，通过才分配资源建连。</li>
</ul>
</li>
</ul>
</li>
<li><strong>反射放大攻击 (Reflection &amp; Amplification)</strong>：<ul>
<li><strong>反射</strong>：伪造受害者IP发UDP包给NTP/DNS服务器，服务器把回包打给受害者（隐藏攻击者IP）。</li>
<li><strong>放大</strong>：利用回包比请求包大的协议（如NTP monlist指令放大556倍），实现小带宽打垮大带宽。</li>
<li><strong>防御</strong>：<strong>源IP过滤 (Ingress/Egress Filtering)</strong>（ISP层面禁止伪造源IP出网）、云端流量清洗 (Scrubbing)。</li>
</ul>
</li>
</ul>
<h2 id="防御设施-Firewall-IDS-IPS"><a href="#防御设施-Firewall-IDS-IPS" class="headerlink" title="防御设施 (Firewall, IDS, IPS)"></a>防御设施 (Firewall, IDS, IPS)</h2><h3 id="防火墙-Firewall"><a href="#防火墙-Firewall" class="headerlink" title="防火墙 (Firewall)"></a>防火墙 (Firewall)</h3><p>防火墙分为2种：</p>
<ul>
<li><strong>无状态 (Packet Filtering)</strong>：只看包头（IP/端口），速度快但无法理解复杂协议（如FTP动态端口）。</li>
<li><strong>有状态 (Stateful)</strong>：维护一张<strong>连接表</strong>。能识别出“这是内部主机发起的连接的回包”，从而自动放行，无需显式规则。</li>
</ul>
<p><img src="/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/image-20251229111458546.png"></p>
<p>如上图，防火墙外是<strong>DMZ (非军事区)</strong>：对外服务的Web/Email服务器放在DMZ，核心数据库在内网。这样，外网只能访问DMZ，DMZ只能受限访问内网，就做到了安全的访问。</p>
<h3 id="IDS-入侵检测-与-IPS-入侵防御"><a href="#IDS-入侵检测-与-IPS-入侵防御" class="headerlink" title="IDS (入侵检测) 与 IPS (入侵防御)"></a>IDS (入侵检测) 与 IPS (入侵防御)</h3><ul>
<li><strong>NIDS (网络型)</strong>：<ul>
<li><em>优点</em>：旁路部署，不影响网络，保护整个网段。</li>
<li><em>缺点</em>：看不懂加密流量 (HTTPS)，易受<strong>分片攻击</strong>（攻击者故意将恶意包切碎，骗过IDS但在主机端重组）。</li>
</ul>
</li>
<li><strong>HIDS (主机型)</strong>：<ul>
<li><em>优点</em>：能看到解密后的数据，检测系统文件完整性。</li>
<li><em>缺点</em>：消耗主机资源。</li>
</ul>
</li>
<li><strong>检测机制</strong>：<ul>
<li><strong>特征码 (Signature)</strong>：匹配已知攻击库。<strong>准，但防不住0-day</strong>。</li>
<li><strong>异常检测 (Anomaly)</strong>：建立基线，检测异常行为。<strong>能防未知攻击，但误报率 (FP) 高</strong>。</li>
</ul>
</li>
<li><strong>准确率陷阱 (Base Rate Fallacy)</strong>：因为网络中正常流量占比极大（Base Rate高），即使检测系统误报率很低（如1%），在海量数据下，<strong>告警中的绝大多数可能依然是误报</strong>。</li>
</ul>
<h2 id="密码学基础-Cryptography"><a href="#密码学基础-Cryptography" class="headerlink" title="密码学基础 (Cryptography)"></a>密码学基础 (Cryptography)</h2><blockquote>
<p>这部分的内容，详见《密码学笔记》。</p>
</blockquote>
<h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><ul>
<li><strong>Kerckhoffs 原则</strong>：<strong>加密算法必须公开</strong>，安全性完全依赖于<strong>密钥 (Key)</strong> 的保密。不要试图通过隐藏算法来保密。</li>
<li><strong>一次一密 (One-Time Pad)</strong>：理论上无法破解（香农证明）。条件是密钥随机、与明文等长、只用一次。<strong>量子密钥分发 (BB84)</strong> 旨在解决OTP的密钥分发难题。</li>
</ul>
<h3 id="对称加密-Symmetric-Key"><a href="#对称加密-Symmetric-Key" class="headerlink" title="对称加密 (Symmetric Key)"></a>对称加密 (Symmetric Key)</h3><p><img src="/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/image-20251229112835006.png"></p>
<p>其中，对称加密有下面几种<strong>工作模式 (Modes)</strong>：</p>
<ul>
<li><strong>ECB (电子密码本)</strong>：明文分块（分成连续的64 bits块）独立加密。<strong>严重缺陷</strong>：相同的明文块生成相同的密文块，暴露数据模式。</li>
</ul>
<p><img src="/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/image-20251229113636086.png" alt="image-20251229113636086"></p>
<ul>
<li><strong>CBC (密码分组链接)</strong>：引入<strong>IV (初始化向量)</strong>。当前明文块 XOR 前一块的密文，再加密。解决了ECB的问题，但解密不仅需要密钥还需要IV，开销大。</li>
</ul>
<p><img src="/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/image-20251229113538539.png"></p>
<ul>
<li><strong>流密码模式 (CTR/Stream)</strong>：生成密钥流与明文XOR。<strong>致命弱点</strong>：如果(Key, IV)重复使用，通过异或两段密文可以直接消除密钥流，暴露明文差异。</li>
</ul>
<p><img src="/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/image-20251229113603346.png"></p>
<h3 id="公钥加密-Public-Key"><a href="#公钥加密-Public-Key" class="headerlink" title="公钥加密 (Public Key)"></a>公钥加密 (Public Key)</h3><p>解决了密钥分发问题。常见的scheme是<strong>RSA</strong>（基于大整数分解难题）：</p>
<ul>
<li>公钥 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.178ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2288.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mo" transform="translate(855,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(1299.7,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1899.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> 加密：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="16.82ex" height="1.781ex" role="img" focusable="false" viewBox="0 -705 7434.5 787"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mo" transform="translate(1037.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(2093.6,0)"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mi" transform="translate(1138,363) scale(0.707)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g></g><g data-mml-node="mspace" transform="translate(3611.1,0)"></g><g data-mml-node="mi" transform="translate(4444.8,0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(833,0)"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(1333,0)"></path></g><g data-mml-node="mstyle" transform="translate(6333.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(6500.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(6834.5,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>；</li>
<li>私钥 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.3ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2342.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(909,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(1353.7,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1953.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> 解密：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="16.902ex" height="2.117ex" role="img" focusable="false" viewBox="0 -853.7 7470.8 935.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mo" transform="translate(1328.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msup" transform="translate(2384.6,0)"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></g><g data-mml-node="mi" transform="translate(845.3,363) scale(0.707)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g><g data-mml-node="mspace" transform="translate(3647.5,0)"></g><g data-mml-node="mi" transform="translate(4481.2,0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(833,0)"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(1333,0)"></path></g><g data-mml-node="mstyle" transform="translate(6370.2,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(6537.2,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(6870.8,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg></mjx-container>；</li>
</ul>
<blockquote>
<p>数学关系：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="18.138ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 8016.9 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="mi" transform="translate(466,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(1263.8,0)"><path data-c="2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"></path></g><g data-mml-node="mn" transform="translate(2319.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mspace" transform="translate(2819.6,0)"></g><g data-mml-node="mi" transform="translate(3653.2,0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(833,0)"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(1333,0)"></path></g><g data-mml-node="mstyle" transform="translate(5542.2,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(5709.2,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(6042.9,0)"><path data-c="1D719" d="M409 688Q413 694 421 694H429H442Q448 688 448 686Q448 679 418 563Q411 535 404 504T392 458L388 442Q388 441 397 441T429 435T477 418Q521 397 550 357T579 260T548 151T471 65T374 11T279 -10H275L251 -105Q245 -128 238 -160Q230 -192 227 -198T215 -205H209Q189 -205 189 -198Q189 -193 211 -103L234 -11Q234 -10 226 -10Q221 -10 206 -8T161 6T107 36T62 89T43 171Q43 231 76 284T157 370T254 422T342 441Q347 441 348 445L378 567Q409 686 409 688ZM122 150Q122 116 134 91T167 53T203 35T237 27H244L337 404Q333 404 326 403T297 395T255 379T211 350T170 304Q152 276 137 237Q122 191 122 150ZM500 282Q500 320 484 347T444 385T405 400T381 404H378L332 217L284 29Q284 27 285 27Q293 27 317 33T357 47Q400 66 431 100T475 170T494 234T500 282Z"></path></g><g data-mml-node="mo" transform="translate(6638.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(7027.9,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(7627.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>。</p>
</blockquote>
<h2 id="认证与协议-Authentication-Protocol"><a href="#认证与协议-Authentication-Protocol" class="headerlink" title="认证与协议 (Authentication & Protocol)"></a>认证与协议 (Authentication &amp; Protocol)</h2><p>如何安全交换密钥（公钥）？或者说，怎么知道这个公钥真的是Bob的？（防止公钥被篡改）？</p>
<h3 id="公钥基础设施-PKI"><a href="#公钥基础设施-PKI" class="headerlink" title="公钥基础设施 (PKI)"></a>公钥基础设施 (PKI)</h3><ul>
<li><strong>核心问题</strong>：</li>
<li><strong>证书 (Certificate)</strong>：由受信任的 <strong>CA (证书机构)</strong> 签名的文件，绑定了“Bob的身份”和“Bob的公钥”。</li>
<li><strong>信任链</strong>：浏览器内置Root CA的公钥，通过层层验证签名来信任终端证书。</li>
<li><strong>X.509</strong>：证书的标准格式。</li>
<li><strong>撤销机制</strong>：私钥泄露了怎么办？<ul>
<li><strong>CRL</strong>：下载黑名单列表（有延迟）。</li>
<li><strong>OCSP</strong>：实时在线查询证书状态。</li>
</ul>
</li>
</ul>
<h1 id="网络安全应用体系"><a href="#网络安全应用体系" class="headerlink" title="网络安全应用体系"></a>网络安全应用体系</h1><h2 id="网络层安全-IP-Security"><a href="#网络层安全-IP-Security" class="headerlink" title="网络层安全 (IP Security)"></a>网络层安全 (IP Security)</h2><p>在网络层提供安全保障的核心协议是 <strong>IPsec</strong>。它的设计目标是在不改变IP协议（无连接）的前提下，<strong>为数据包提供机密性、完整性和防重放保护</strong>。</p>
<h3 id="IPsec-架构与原理"><a href="#IPsec-架构与原理" class="headerlink" title="IPsec 架构与原理"></a>IPsec 架构与原理</h3><p>虽然IP层本身是无连接的，但IPsec引入了 <strong>SA (Security Association，安全关联)</strong> 的概念，模拟了一种“面向连接”的安全状态，每个SA由三元组标识：<code>(SPI, 目的IP, 协议类型)</code>。如果A和B要进行双向安全通信，必须建立<strong>两个</strong>SA（A-&gt;B 和 B-&gt;A）。</p>
<p>IPsec使用<strong>ISAKMP/IKE</strong>协议进行控制。它用于双方协商密钥、加密算法，并建立SA，解决了“密钥如何分发”的问题。</p>
<h3 id="IPsec-的实现"><a href="#IPsec-的实现" class="headerlink" title="IPsec 的实现"></a>IPsec 的实现</h3><p>IPsec通过向IP包中插入新的头部来实现安全功能，有2种方式：</p>
<ul>
<li><strong>AH (Authentication Header)</strong>：仅提供<strong>完整性校验</strong>（HMAC）和<strong>防重放</strong>（序列号），<strong>不提供机密性</strong>（不加密数据）。但是，因为它会校验IP头中的部分字段，导致NAT（网络地址转换）难以穿越（NAT会修改IP头，导致校验失败）。</li>
</ul>
<p><img src="/./%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/image-20251229121742215.png"></p>
<ul>
<li><strong>ESP (Encapsulating Security Payload)</strong>：包含SPI、序列号、初始化向量(IV)等。它是目前最常用的协议。提供<strong>机密性</strong>（加密Payload）、<strong>完整性</strong>和<strong>防重放</strong>。</li>
</ul>
<h3 id="IPsec-的工作模式-Transport-vs-Tunnel"><a href="#IPsec-的工作模式-Transport-vs-Tunnel" class="headerlink" title="IPsec 的工作模式 (Transport vs. Tunnel)"></a>IPsec 的工作模式 (Transport vs. Tunnel)</h3><p>IPsec提供2种工作模式：</p>
<p><img src="/./%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/image-20251229121816173.png"></p>
<ul>
<li><strong>传输模式 (Transport Mode)</strong>：只加密/认证IP包的<strong>载荷 (Payload)</strong>（如TCP/UDP段），保留原始IP头。但是，暴露了源和目的IP，流量分析可见。</li>
<li><strong>隧道模式 (Tunnel Mode)</strong>：将<strong>整个原始IP包</strong>（包括头和载荷）加密封装，作为一个新IP包的载荷，并加上<strong>新的IP头</strong>。隐藏了内部网络的拓扑和通信双方的真实IP。</li>
</ul>
<blockquote>
<p>两种模式的应用场景：</p>
<ul>
<li><strong>传输模式 (Transport Mode)</strong>：适用<strong>端到端通信</strong>（Host-to-Host）。例如两个主机直接建立加密连接。</li>
<li><strong>隧道模式 (Tunnel Mode)</strong>：适用<strong>网关到网关</strong>（VPN）。例如公司总部的路由器和分公司的路由器建立连接，内部主机对此无感知。</li>
</ul>
</blockquote>
<h3 id="VPN-虚拟专用网"><a href="#VPN-虚拟专用网" class="headerlink" title="VPN (虚拟专用网)"></a>VPN (虚拟专用网)</h3><p>VPN的本质是在公共网络（Internet）上叠加（Overlay）一个私有网络。</p>
<ul>
<li><strong>基于IPsec的VPN</strong>：利用IPsec的隧道模式，在公网上建立加密隧道。</li>
<li><strong>MPLS VPN (基于标签交换)</strong>：<ul>
<li><strong>原理</strong>：ISP在链路层和网络层之间引入<strong>标签 (Label)</strong>。路由器（LER/LSR）不再查路由表，而是根据标签转发。</li>
<li><strong>FEC (转发等价类)</strong>：将流向同一目的地的流量归为一类，打上相同标签。</li>
<li><strong>特点</strong>：主要用于流量工程和隔离，本身不一定提供强加密，依靠ISP的网络隔离保障安全。</li>
</ul>
</li>
</ul>
<h2 id="无线网络安全-Wireless-Security"><a href="#无线网络安全-Wireless-Security" class="headerlink" title="无线网络安全 (Wireless Security)"></a>无线网络安全 (Wireless Security)</h2><p>无线环境是开放介质，任何人都能抓包，因此安全需求极高。它的标准演进路线为：WEP (已弃用) -&gt; WPA -&gt; <strong>WPA2 (802.11i)</strong>。下面我们依次介绍。</p>
<h3 id="WPA2-802-11i-架构"><a href="#WPA2-802-11i-架构" class="headerlink" title="WPA2/802.11i 架构"></a>WPA2/802.11i 架构</h3><ul>
<li><strong>家庭模式 (Personal/PSK)</strong>：所有设备共享同一个密码（Pre-Shared Key）。适合无中心服务器环境。</li>
<li><strong>企业模式 (Enterprise/802.1X)</strong>：<ul>
<li>引入 <strong>AS (认证服务器，如RADIUS)</strong>。</li>
<li>使用 <strong>EAP (可扩展认证协议)</strong> 进行认证。</li>
<li>每个用户有独立的账号密码，安全性更高。</li>
</ul>
</li>
</ul>
<h3 id="2-加密协议演进"><a href="#2-加密协议演进" class="headerlink" title="2. 加密协议演进"></a>2. 加密协议演进</h3><ul>
<li><strong>TKIP (临时密钥完整性协议)</strong>：为了兼容旧硬件（WEP时代的旧网卡）而设计的“补丁”方案。虽然比WEP强，但仍不够安全。</li>
<li><strong>CCMP</strong>：WPA2的强制标准。<ul>
<li><strong>加密</strong>：使用 <strong>AES</strong> 算法的计数器模式 (CTR) 提供机密性。</li>
<li><strong>完整性</strong>：使用 <strong>CBC-MAC</strong> 提供消息认证（MIC）。</li>
<li><strong>安全性</strong>：目前公认的安全标准。</li>
</ul>
</li>
</ul>
<h3 id="密钥交换-4-Way-Handshake"><a href="#密钥交换-4-Way-Handshake" class="headerlink" title="密钥交换 (4-Way Handshake)"></a>密钥交换 (4-Way Handshake)</h3><p>在认证成功后，客户端和接入点（AP）通过四次握手协商出<strong>会话密钥 (Session Key)</strong>。</p>
<ul>
<li><strong>目的</strong>：确认双方拥有共同的Master Key，并生成用于加密实际数据的PTK（成对临时密钥）。</li>
<li><strong>防重放</strong>：握手过程中包含Nonce（随机数）和MIC。</li>
</ul>
<h2 id="应用层安全-Email-Web"><a href="#应用层安全-Email-Web" class="headerlink" title="应用层安全 (Email & Web)"></a>应用层安全 (Email &amp; Web)</h2><h3 id="电子邮件安全"><a href="#电子邮件安全" class="headerlink" title="电子邮件安全"></a>电子邮件安全</h3><p>邮件系统本质是存储转发的，且涉及多跳，因此需要端到端的安全。</p>
<h4 id="PGP-Pretty-Good-Privacy"><a href="#PGP-Pretty-Good-Privacy" class="headerlink" title="PGP (Pretty Good Privacy)"></a>PGP (Pretty Good Privacy)</h4><ul>
<li><strong>信任模型</strong>：<strong>去中心化 (Web of Trust)</strong>。没有权威CA，用户通过“私钥环”和“公钥环”管理密钥，用户之间互相签名认证（“我相信Bob，Bob相信Alice，所以我相信Alice”）。</li>
<li><strong>发送流程 (发送方)</strong>：<ol>
<li><strong>签名</strong>：对消息做Hash (SHA-2) -&gt; 用<strong>发送方私钥</strong>加密Hash（数字签名）。</li>
<li><strong>压缩</strong>：对（消息+签名）进行压缩（如ZIP）。<strong>注意：先签名后压缩，还是先压缩后签名？PGP是先签名，再压缩，再加密。这样解密后直接验证原始数据。</strong></li>
<li><strong>加密</strong>：生成一个<strong>一次性会话密钥 (Session Key)</strong>，用AES加密压缩后的数据。</li>
<li><strong>封装</strong>：用<strong>接收方公钥</strong>加密这个会话密钥，附在消息前。</li>
</ol>
</li>
<li><strong>特点</strong>：由于使用了对称加密处理正文，公钥加密处理会话密钥，效率很高。</li>
</ul>
<h4 id="S-MIME"><a href="#S-MIME" class="headerlink" title="S/MIME"></a>S/MIME</h4><ul>
<li><strong>信任模型</strong>：<strong>中心化 (PKI/CA)</strong>。依赖X.509证书链，类似于HTTPS。企业环境常用。</li>
<li><strong>功能</strong>：提供EnvelopedData（加密）和SignedData（签名）。通常会对邮件内容进行Base64编码以适应传输。</li>
</ul>
<h3 id="Web-安全-DNSSEC-TLS"><a href="#Web-安全-DNSSEC-TLS" class="headerlink" title="Web 安全 (DNSSEC & TLS)"></a>Web 安全 (DNSSEC &amp; TLS)</h3><h4 id="DNSSEC-DNS安全扩展"><a href="#DNSSEC-DNS安全扩展" class="headerlink" title="DNSSEC (DNS安全扩展)"></a>DNSSEC (DNS安全扩展)</h4><p>解决DNS欺骗（如Kaminsky攻击）的终极方案。</p>
<ul>
<li><strong>原理</strong>：为DNS记录提供<strong>数字签名</strong>。</li>
<li><strong>记录类型</strong>：<ul>
<li><strong>RRSIG</strong>：资源记录的签名。</li>
<li><strong>DNSKEY</strong>：存储Zone的公钥（用于验证RRSIG）。</li>
<li><strong>RRSET</strong>：将相同类型的记录打包集合。</li>
</ul>
</li>
<li><strong>信任链</strong>：从根域名（.）到顶级域（.com）再到二级域（bob.com），逐级签名背书。浏览器/解析器只需信任根的公钥即可验证整条链。</li>
</ul>
<h4 id="TLS-传输层安全"><a href="#TLS-传输层安全" class="headerlink" title="TLS (传输层安全)"></a>TLS (传输层安全)</h4><p>即SSL的继任者，位于TCP之上，应用层之下。</p>
<ul>
<li><strong>握手阶段</strong>：<ol>
<li>协商版本和加密套件 (Cipher Suite)。</li>
<li>服务器发送证书 (Server Hello)，客户端验证证书。</li>
<li><strong>SNI (Server Name Indication)</strong>：客户端在Hello中明文（TLS 1.3前）或加密（ECH）告知要访问的域名，解决同IP多证书问题。</li>
<li>生成<strong>预主密钥 (Premaster Secret)</strong>，结合随机数生成会话密钥。</li>
</ol>
</li>
<li><strong>记录协议</strong>：使用协商好的对称密钥（如AES-GCM）加密传输HTTP数据。</li>
</ul>
<h3 id="浏览器端安全"><a href="#浏览器端安全" class="headerlink" title="浏览器端安全"></a>浏览器端安全</h3><p>浏览器是“不受信任代码”的执行环境。</p>
<ul>
<li><strong>沙盒 (Sandbox)</strong>：限制脚本读写本地文件或访问其他页面数据。</li>
<li><strong>恶意代码威胁</strong>：<ul>
<li><strong>XSS (跨站脚本)</strong>：窃取Cookie/隐私。</li>
<li><strong>CSRF (跨站请求伪造)</strong>：冒充用户发起请求。</li>
<li><strong>Drive-by Download</strong>：路过式下载，浏览即中毒。</li>
</ul>
</li>
<li><strong>插件风险</strong>：Flash/PDF插件常有漏洞，应按需加载。</li>
</ul>
<hr>
<h2 id="第九部分：社会与法律议题"><a href="#第九部分：社会与法律议题" class="headerlink" title="第九部分：社会与法律议题"></a>第九部分：社会与法律议题</h2><ul>
<li><strong>隐私 (Privacy)</strong>：<ul>
<li><strong>洋葱路由 (Onion Routing/Tor)</strong>：通过多层加密和随机跳板（节点）转发，使得每一跳只知道前一跳和后一跳，无法得知完整的通信路径，实现匿名。</li>
</ul>
</li>
<li><strong>隐写术 (Steganography)</strong>：<ul>
<li>将秘密信息隐藏在非秘密载体中（如修改图片的低位比特 LSB），不仅加密内容，甚至<strong>隐藏了“通信正在发生”这一事实</strong>。</li>
</ul>
</li>
<li><strong>版权 (Copyright)</strong>：<ul>
<li>数字水印（利用隐写术）。</li>
<li><strong>合理使用 (Fair Use)</strong>：在特定场景（教学、备份、引用）下，允许有限度地使用受版权保护的内容。</li>
</ul>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://stellarhui.github.io">摘星的辉</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://stellarhui.github.io/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/">https://stellarhui.github.io/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec7%EF%BC%9A%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%80%E4%BB%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://stellarhui.github.io" target="_blank">皓月星辰</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/favicon.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec8%EF%BC%9A%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/" title="计算机网络（8）：期末复习"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">计算机网络（8）：期末复习</div></div><div class="info-2"><div class="info-item-1"> 期末的一些题目整理。  </div></div></div></a><a class="pagination-related" href="/2025/12/22/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9CLec6%EF%BC%9A%E5%BA%94%E7%94%A8%E5%B1%82/" title="计算机网络（6）：应用层"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">计算机网络（6）：应用层</div></div><div class="info-2"><div class="info-item-1">网络应用模型主机之间如何进行交互？可以分为2种组织架构：  C/S模型（客户端/服务器模型） P2P模型   注意：  P2P网络是一个构建在IP网络上的覆盖网络，是一种动态的逻辑网络（而非物理网络！）。 C/S模型中，客户不可以直接通信。 在C/S模型中，服务器也可以主动向客户发送信息，比如报错信息。   域名系统Domain Name System (DNS)系统将网站名称（实际是**（一群）主机名**）映射至IP地址。   注意：  DNS映射的多样性：（1）域名与IP, MAC, 主机都不具有一一对应的关系！（2）域名在不同的时间可以解析出不同的IP地址。 各种DNS服务器：每台主机都必须在权限域名服务器处注册登记，权限域名服务器一定能够将其管辖的主机名转换为该主机的IP地址。    注意综合题型：假设下图所示网络中的本地域名服务器只提供递归查询服务，其他域名服务器均只提供迭代查询服务；局域网内主机访问Internet上各服务器的往返时间（RTT）均为10ms，忽略其他各种时延。若主机H通过超链接 http://www.abc.com/index.html 请求浏览纯文本...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">网络安全原理与基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E6%A6%82%E5%BF%B5%E4%B8%8E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99"><span class="toc-number">1.1.</span> <span class="toc-text">安全概念与基本原则</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%9B%AE%E6%A0%87%EF%BC%9ACIA-Triad"><span class="toc-number">1.1.1.</span> <span class="toc-text">核心目标：CIA Triad</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99-Saltzer-Schroeder"><span class="toc-number">1.1.2.</span> <span class="toc-text">安全设计原则 (Saltzer &amp; Schroeder)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%8A%80%E6%9C%AF-Attacks"><span class="toc-number">1.2.</span> <span class="toc-text">攻击技术 (Attacks)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%A6%E5%AF%9F-Reconnaissance"><span class="toc-number">1.2.1.</span> <span class="toc-text">侦察 (Reconnaissance)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F-Port-Scanning"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">端口扫描 (Port Scanning)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E6%8E%A2%E6%B5%8B-Traceroute"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">路由探测 (Traceroute)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%97%85%E6%8E%A2%E4%B8%8E%E6%AC%BA%E9%AA%97-Sniffing-Spoofing"><span class="toc-number">1.2.2.</span> <span class="toc-text">嗅探与欺骗 (Sniffing &amp; Spoofing)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-%E9%93%BE%E8%B7%AF%E5%B1%82%EF%BC%9A%E7%AA%81%E7%A0%B4%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%9A%94%E7%A6%BB"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">A. 链路层：突破交换机隔离</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#B-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9AIP%E6%AC%BA%E9%AA%97%E4%B8%8E%E4%BE%A7%E4%BF%A1%E9%81%93%E6%94%BB%E5%87%BB"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">B. 网络层：IP欺骗与侧信道攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%9ADNS-%E6%AC%BA%E9%AA%97-DNS-Spoofing"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">C. 应用层：DNS 欺骗 (DNS Spoofing)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%A0%B4%E5%9D%8F-DoS-DDoS"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. 破坏 (DoS&#x2F;DDoS)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1%E8%AE%BE%E6%96%BD-Firewall-IDS-IPS"><span class="toc-number">1.3.</span> <span class="toc-text">防御设施 (Firewall, IDS, IPS)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E7%81%AB%E5%A2%99-Firewall"><span class="toc-number">1.3.1.</span> <span class="toc-text">防火墙 (Firewall)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDS-%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B-%E4%B8%8E-IPS-%E5%85%A5%E4%BE%B5%E9%98%B2%E5%BE%A1"><span class="toc-number">1.3.2.</span> <span class="toc-text">IDS (入侵检测) 与 IPS (入侵防御)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80-Cryptography"><span class="toc-number">1.4.</span> <span class="toc-text">密码学基础 (Cryptography)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.4.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86-Symmetric-Key"><span class="toc-number">1.4.2.</span> <span class="toc-text">对称加密 (Symmetric Key)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86-Public-Key"><span class="toc-number">1.4.3.</span> <span class="toc-text">公钥加密 (Public Key)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%81%E4%B8%8E%E5%8D%8F%E8%AE%AE-Authentication-Protocol"><span class="toc-number">1.5.</span> <span class="toc-text">认证与协议 (Authentication &amp; Protocol)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD-PKI"><span class="toc-number">1.5.1.</span> <span class="toc-text">公钥基础设施 (PKI)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E7%94%A8%E4%BD%93%E7%B3%BB"><span class="toc-number">2.</span> <span class="toc-text">网络安全应用体系</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E5%AE%89%E5%85%A8-IP-Security"><span class="toc-number">2.1.</span> <span class="toc-text">网络层安全 (IP Security)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IPsec-%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.1.</span> <span class="toc-text">IPsec 架构与原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPsec-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.1.2.</span> <span class="toc-text">IPsec 的实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPsec-%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F-Transport-vs-Tunnel"><span class="toc-number">2.1.3.</span> <span class="toc-text">IPsec 的工作模式 (Transport vs. Tunnel)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VPN-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91"><span class="toc-number">2.1.4.</span> <span class="toc-text">VPN (虚拟专用网)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8-Wireless-Security"><span class="toc-number">2.2.</span> <span class="toc-text">无线网络安全 (Wireless Security)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WPA2-802-11i-%E6%9E%B6%E6%9E%84"><span class="toc-number">2.2.1.</span> <span class="toc-text">WPA2&#x2F;802.11i 架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8A%A0%E5%AF%86%E5%8D%8F%E8%AE%AE%E6%BC%94%E8%BF%9B"><span class="toc-number">2.2.2.</span> <span class="toc-text">2. 加密协议演进</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2-4-Way-Handshake"><span class="toc-number">2.2.3.</span> <span class="toc-text">密钥交换 (4-Way Handshake)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%E5%AE%89%E5%85%A8-Email-Web"><span class="toc-number">2.3.</span> <span class="toc-text">应用层安全 (Email &amp; Web)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E5%AE%89%E5%85%A8"><span class="toc-number">2.3.1.</span> <span class="toc-text">电子邮件安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#PGP-Pretty-Good-Privacy"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">PGP (Pretty Good Privacy)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#S-MIME"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">S&#x2F;MIME</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web-%E5%AE%89%E5%85%A8-DNSSEC-TLS"><span class="toc-number">2.3.2.</span> <span class="toc-text">Web 安全 (DNSSEC &amp; TLS)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DNSSEC-DNS%E5%AE%89%E5%85%A8%E6%89%A9%E5%B1%95"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">DNSSEC (DNS安全扩展)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TLS-%E4%BC%A0%E8%BE%93%E5%B1%82%E5%AE%89%E5%85%A8"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">TLS (传输层安全)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%AB%AF%E5%AE%89%E5%85%A8"><span class="toc-number">2.3.3.</span> <span class="toc-text">浏览器端安全</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B9%9D%E9%83%A8%E5%88%86%EF%BC%9A%E7%A4%BE%E4%BC%9A%E4%B8%8E%E6%B3%95%E5%BE%8B%E8%AE%AE%E9%A2%98"><span class="toc-number">2.4.</span> <span class="toc-text">第九部分：社会与法律议题</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/background.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 - 2026 By 摘星的辉</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div><div class="footer_custom_text"><div style="text-align:center; margin-top:20px;">
  <div style="margin-top:10px;">
    今天也要继续加油哦！
  </div>
</div>
</div></div><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@undefined/dist/mermaid.min.js?v=undefined"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptions'));
  mermaid.initialize(options);
}</script></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script id="canvas_nest" defer="defer" color="100,149,237" opacity="0.6" zIndex="-1" count="70" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>